<!doctype html><html lang="en">
 <head>
  <meta content="text/html; charset=utf-8" http-equiv="Content-Type">
  <title>Geofencing API</title>
  <link href="https://www.w3.org/StyleSheets/TR/W3C-ED" rel="stylesheet" type="text/css">
<style data-fill-with="stylesheet">/* This section copied from the W3C's ED styles. */

	body {
		color: black;
		font-family: sans-serif;
		margin: 0 auto;
		max-width: 50em;
		padding: 2em 1em 2em 70px;
	}
	:link { color: #00C; background: transparent }
	:visited { color: #609; background: transparent }
	a[href]:active { color: #C00; background: transparent }
	a[href]:hover { background: #ffa }

	a[href] img { border-style: none }

	h1, h2, h3, h4, h5, h6 { text-align: left }
	h1, h2, h3 { color: #005A9C; }
	h1 { font: 170% sans-serif }
	h2 { font: 140% sans-serif }
	h3 { font: 120% sans-serif }
	h4 { font: bold 100% sans-serif }
	h5 { font: italic 100% sans-serif }
	h6 { font: small-caps 100% sans-serif }

	.hide { display: none }

	div.head { margin-bottom: 1em }
	div.head h1 { margin-top: 2em; clear: both }
	div.head table { margin-left: 2em; margin-top: 2em }

	p.copyright { font-size: small }
	p.copyright small { font-size: small }

	pre { margin-left: 2em }
	dt { font-weight: bold }

	ul.toc, ol.toc {
		list-style: none;
	}

/* The rest copied from the CSSWG's default.css */

	body {
		counter-reset: exampleno figure issue;
		max-width: 50em;
		margin: 0 auto !important;
		line-height: 1.5;
	}

/******************************************************************************/
/*                                Sectioning                                  */
/******************************************************************************/

/** Headings ******************************************************************/

	h1, h2, h3, h4, h5, h6, dt {
		page-break-after: avoid;
	}

	h2, h3, h5, h6 {
		margin-top: 3em;
	}
	h4 {
		 margin-top: 4em;
	}

/** Subheadings ***************************************************************/

	h1 + h2,
	#subtitle + h2 {
		/* #subtitle is a subtitle in an H2 under the H1 */
		margin-top: 0;
	}
	h2 + h3,
	h3 + h4,
	h4 + h5,
	h5 + h6 {
		margin-top: 1.2em; /* = 1 x line-height */
	}

/** Section divider ***********************************************************/
	/* <hr> used to separate TMI into the second half of a section              */
	hr:not([title]) {
		font-size: 1.5em;
		text-align: center;
		margin: 1em auto;
		height: auto;
		border: transparent solid 0;
		background: transparent;
	}
	hr:not([title])::before {
		content: "\1F411\2003\2003\1F411\2003\2003\1F411";
	}
	/* note: <hr> with title separates document header from contents */

/******************************************************************************/
/*                            Paragraphs and Lists                            */
/******************************************************************************/

	p {
		margin: 1em 0;
	}
	dd     > p:first-child,
	li     > p:first-child {
		margin-top: 0;
	}

	ul, ol {
		margin-left: 0;
		padding-left: 2em;
	}
	li {
		margin: 0.25em 2em 0.5em 0;
		padding-left: 0;
	}

	dl dd {
		margin: 0 0 1em 2em;
	}
	.head dd {
		margin-bottom: 0;
	}

	/* Style for algorithms */
	ol.algorithm ol {
	 border-left: 1px solid #90b8de;
	 margin-left: 1em;
	}
	ol.algorithm ol.algorithm {
	 border-left: none;
	 margin-left: 0;
	}

	/* Style for switch/case <dl>s */
	dl.switch > dd > ol.only {
	 margin-left: 0;
	}
	dl.switch > dd > ol.algorithm {
	 margin-left: -2em;
	}
	dl.switch {
	 padding-left: 2em;
	}
	dl.switch > dt {
	 text-indent: -1.5em;
	 margin-top: 1em;
	}
	dl.switch > dt + dt {
	 margin-top: 0;
	}
	dl.switch > dt::before {
	 content: '\21AA';
	 padding: 0 0.5em 0 0;
	 display: inline-block;
	 width: 1em;
	 text-align: right;
	 line-height: 0.5em;
	}

	/* Style for paragraphs I know are in MD-genned lists */
	[data-md] > :first-child {
		margin-top: 0;
	}
	[data-md] > :last-child {
		margin-bottom: 0;
	}

/** Inline Lists **************************************************************/
	/* This is mostly to make the list inside the CR exit criteria more compact. */

	ol.inline, ol.inline li {
		display: inline;
		padding: 0; margin: 0;
	}
	ol.inline {
		counter-reset: list-item;
	}
	ol.inline li {
		counter-increment: list-item;
	}
	ol.inline li::before {
		content: "(" counter(list-item) ") ";
		font-weight: bold;
	}

/** Terminology Markup ********************************************************/


/******************************************************************************/
/*                                 Inline Markup                              */
/******************************************************************************/

/** Terminology Markup ********************************************************/
	dfn   { /* Defining instance */
		font-weight: bolder;
	}
	a > i { /* Instance of term */
		font-style: normal;
	}
	dt dfn code, code.idl {
		font-size: inherit;
	}
	dfn var {
		font-style: normal;
	}

/** Change Marking ************************************************************/

	del { color: red;  text-decoration: line-through; }
	ins { color: #080; text-decoration: underline;    }

/** Miscellaneous improvements to inline formatting ***************************/

	sup {
		vertical-align: super;
		font-size: 80%
	}

/******************************************************************************/
/*                                    Code                                    */
/******************************************************************************/

/** General monospace/pre rules ***********************************************/

	pre, code {
		font-family: Menlo, Consolas, "DejaVu Sans Mono", monospace;
		font-size: .9em;
		page-break-inside: avoid;
	}
	pre {
		margin-top: 1em;
		margin-bottom: 1em;
		overflow: auto;
	}

/** Syntax-Highlighted Code ***************************************************/

	.example pre[class*="language-"],
	.example [class*="language-"] pre,
	.example pre[class*="lang-"],
	.example [class*="lang-"] pre {
		background: transparent; /* Prism applies a gray background that doesn't work well in the template. */
	}

/** Example Code **************************************************************/

	div.html, div.xml,
	pre.html, pre.xml {
		padding: 0.5em;
		margin: 1em 0;
		position: relative;
		clear: both;
		color: #600;
	}
	pre.example,
	pre.html,
	pre.xml {
		padding-top: 1.5em;
	}

	pre.illegal, .illegal pre
	pre.deprecated, .deprecated pre {
		color: red;
	}

/** IDL fragments *************************************************************/

	pre.idl {
		/* Match blue propdef boxes */
		padding: .5em 1em;
		background: #DEF;
		margin: 1.2em 0;
		border-left: 0.5em solid #8CCBF2;
	}
	pre.idl :link, pre.idl :visited {
		color:inherit;
		background:transparent;
	}

/** Inline CSS fragments ******************************************************/

	.css.css, .property.property, .descriptor.descriptor {
		color: #005a9c;
		font-size: inherit;
		font-family: inherit;
	}
	.css::before, .property::before, .descriptor::before {
		content: "‘";
	}
	.css::after, .property::after, .descriptor::after {
		content: "’";
	}
	.property, .descriptor {
		/* Don't wrap property and descriptor names */
		white-space: nowrap;
	}
	.type { /* CSS value <type> */
	font-style: italic;
	}
	pre .property::before, pre .property::after {
		content: "";
	}

/** Inline markup fragments ***************************************************/

	code.html, code.xml {
		color: #660000;
	}

/** Autolinks produced using Bikeshed *****************************************/

	[data-link-type="property"]::before,
	[data-link-type="propdesc"]::before,
	[data-link-type="descriptor"]::before,
	[data-link-type="value"]::before,
	[data-link-type="function"]::before,
	[data-link-type="at-rule"]::before,
	[data-link-type="selector"]::before,
	[data-link-type="maybe"]::before {
		content: "‘";
	}
	[data-link-type="property"]::after,
	[data-link-type="propdesc"]::after,
	[data-link-type="descriptor"]::after,
	[data-link-type="value"]::after,
	[data-link-type="function"]::after,
	[data-link-type="at-rule"]::after,
	[data-link-type="selector"]::after,
	[data-link-type="maybe"]::after {
		content: "’";
	}

	[data-link-type].production::before,
	[data-link-type].production::after,
	.prod [data-link-type]::before,
	.prod [data-link-type]::after {
		content: "";
	}

	[data-link-type=element]         { font-family: monospace; }
	[data-link-type=element]::before { content: "<" }
	[data-link-type=element]::after  { content: ">" }

	[data-link-type=biblio] {
		white-space: pre;
	}


/******************************************************************************/
/*                                    Links                                   */
/******************************************************************************/

/** General Hyperlinks ********************************************************/

	/* We hyperlink a lot, so make it less intrusive */
	a:link, a:visited {
		color: inherit;
		text-decoration: none;
		border-bottom: 1px solid silver;
	}
	@supports (text-decoration-color: silver) {
		a:link, a:visited {
			border-bottom: none;
			text-decoration: underline;
			text-decoration-color: silver;
		}
		a:visited {
			text-decoration-style: dotted;
		}
	}

	a.logo:link, a.logo:visited { /* backout above styling for W3C logo */
		padding: 0;
		border: none;
		text-decoration: none;
	}

/** Self-Links ****************************************************************/
	/* Auto-generated links from an element to its own anchor, for usability */

	.heading, .issue, .note, .example, li, dt {
		position: relative;
	}
	a.self-link {
		position: absolute;
		top: 0;
		left: -2.5em;
		width: 2em;
		height: 2em;
		text-align: center;
		border: none;
		transition: opacity .2s;
		opacity: .5;
	}
	a.self-link:hover {
		opacity: 1;
	}
	.heading > a.self-link {
		font-size: 83%;
	}
	li > a.self-link {
		left: -3.5em;
	}
	dfn > a.self-link {
		top: auto;
		left: auto;
		opacity: 0;
		width: 1.5em;
		height: 1.5em;
		background: gray;
		color: white;
		font-style: normal;
		transition: opacity .2s, background-color .2s, color .2s;
	}
	dfn:hover > a.self-link {
		opacity: 1;
	}
	dfn > a.self-link:hover {
		color: black;
	}

	a.self-link::before            { content: "¶"; }
	.heading > a.self-link::before { content: "§"; }
	dfn > a.self-link::before      { content: "#"; }

/******************************************************************************/
/*                                    Images                                  */
/******************************************************************************/

	img {
		border-style: none;
		color: white;
	}

	figure, div.figure, div.sidefigure {
		page-break-inside: avoid;
	}

	div.figure, p.figure, div.sidefigure, figure {
		text-align: center;
		margin: 2.5em 0;
	}
	div.figure pre, div.sidefigure pre, figure pre {
		text-align: left;
		display: table;
		margin: 1em auto;
	}
	.figure table, figure table {
		margin: auto;
	}
	div.sidefigure, figure.sidefigure {
		float: right;
		width: 50%;
		margin: 0 0 0.5em 0.5em
	}
	div.figure img, div.sidefigure img, figure img,
	div.figure object, div.sidefigure object, figure object {
		display: block;
		margin: auto;
		max-width: 100%
	}
	p.caption, figcaption, caption {
		text-align: center;
		font-style: italic;
		font-size: 90%;
	}
	p.caption:not(.no-marker)::before, figcaption:not(.no-marker)::before {
		content: "Figure " counter(figure) ". ";
	}
	p.caption::before, figcaption::before, figcaption > .marker {
		font-weight: bold;
	}
	p.caption, figcaption {
		counter-increment: figure;
	}

	/* DL list is indented 2em, but figure inside it is not */
	dd > div.figure, dd > figure { margin-left: -2em }

	pre.ascii-art {
		display: table; /* shrinkwrap */
		margin: 1em auto;
	}

	/* Displaying the output of text layout, particularly when
		 line-breaking is being invoked, and thus having a
		 visible width is good. */
	pre.output {
		margin: 1em;
		border: solid thin silver;
		padding: 0.25em;
		display: table;
	}

/******************************************************************************/
/*                             Colored Boxes                                  */
/******************************************************************************/

	.issue, .note, .example, .why, .advisement, blockquote {
		padding: .5em;
		border: .5em;
		border-left-style: solid;
		page-break-inside: avoid;
	}
	span.issue, span.note {
		padding: .1em .5em .15em;
		border-right-style: solid;
	}

	div.issue,
	div.note,
	div.example,
	details.why,
	blockquote {
		margin: 1em auto;
	}
	.note  > p:first-child,
	.issue > p:first-child,
	blockquote > :first-child {
		margin-top: 0;
	}
	blockquote > :last-child {
		margin-bottom: 0;
	}

/** Blockquotes ***************************************************************/

	blockquote {
		border-color: silver;
	}

/** Open issue ****************************************************************/
	/* not intended for CR+ publication */

	.issue {
		border-color: #E05252;
		background: #FBE9E9;
		counter-increment: issue;
		overflow: auto;
	}
	.issue:not(.no-marker)::before {
		content: "ISSUE " counter(issue);
		padding-right: 1em;
	}
	.issue::before, .issue > .marker {
		color: #AE1E1E;
	}

/** Example *******************************************************************/

	.example {
		border-color: #E0CB52;
		background: #FCFAEE;
		counter-increment: exampleno;
		overflow: auto;
		clear: both;
	}
	.example::before, .example > .marker {
		color: #827017;
		font-family: sans-serif;
		min-width: 7.5em;
		display: block;
	}
	.example:not(.no-marker)::before {
		content: "EXAMPLE";
		content: "EXAMPLE " counter(exampleno);
	}
	.invalid.example::before, .invalid.example > .marker,
	.illegal.example::before, .illegal.example > .marker {
		color: red;
	}
	.invalid.example:not(.no-marker)::before,
	.illegal.example:not(.no-marker)::before {
		content: "INVALID EXAMPLE";
		content: "INVALID EXAMPLE" counter(exampleno);
	}

/** Non-normative Note ********************************************************/

	.note, .why {
		border-color: #52E052;
		background: #E9FBE9;
		overflow: auto;
	}
	.note::before, .note > .marker {
		display: block;
		color: hsl(120, 70%, 30%);
	}

/** Advisement Box ************************************************************/
	/*  for attention-grabbing normative statements */

	.advisement {
		border-color: orange;
		border-style: none solid;
		background: #FFEECC;
		text-align: center;
	}
	strong.advisement {
		display: block;
	}
	/*.advisement::before { color: #FF8800; } */

/** ??? ***********************************************************************/

	details.why {
		border-color: #52E052;
		background: #E9FBE9;
		display: block;
	}

	details.why > summary {
		font-style: italic;
		display: block;
	}

	details.why[open] > summary {
		border-bottom: 1px silver solid;
	}

/** Spec Obsoletion Notice ****************************************************/
	/* obnoxious obsoletion notice for older/abandoned specs. */

	details.annoying-warning {
		display: block;
	}

	details.annoying-warning[open] {
		background: #fdd;
		color: red;
		font-weight: bold;
		text-align: center;
		padding: .5em;
		border: thick solid red;
		border-radius: 1em;
	}
@media not print {
	details.annoying-warning[open] {
		position: fixed;
		left: 1em;
		right: 1em;
		bottom: 1em;
		z-index: 1000;
	}
}

	details.annoying-warning:not([open]) > summary {
		background: #fdd;
		color: red;
		font-weight: bold;
		text-align: center;
		padding: .5em;
	}

/******************************************************************************/
/*                                    Tables                                  */
/******************************************************************************/

/** Property/Descriptor Definition Tables *************************************/

	table.propdef, table.propdef-extra,
	table.descdef, table.definition-table {
		page-break-inside: avoid;
		width: 100%;
		margin: 1.2em 0;
		border-left: 0.5em solid #8CCBF2;
		padding: 0.5em 1em;
		background: #DEF;
		border-spacing: 0;
	}

	table.propdef td, table.propdef-extra td,
	table.descdef td, table.definition-table td,
	table.propdef th, table.propdef-extra th,
	table.descdef th, table.definition-table th {
		padding: 0.5em;
		vertical-align: baseline;
		border-bottom: 1px solid #bbd7e9;
	}
	table.propdef > tbody > tr:last-child th,
	table.propdef-extra > tbody > tr:last-child th,
	table.descdef > tbody > tr:last-child th,
	table.definition-table > tbody > tr:last-child th,
	table.propdef > tbody > tr:last-child td,
	table.propdef-extra > tbody > tr:last-child td,
	table.descdef > tbody > tr:last-child td,
	table.definition-table > tbody > tr:last-child td {
		border-bottom: 0;
	}

	table.propdef th,
	table.propdef-extra th,
	table.descdef th,
	table.definition-table th {
		font-style: italic;
		font-weight: normal;
		width: 8.3em;
		padding-left: 1em;
	}

	/* For when values are extra-complex and need formatting for readability */
	table td.pre {
		white-space: pre-wrap;
	}

	/* A footnote at the bottom of a propdef */
	table.propdef td.footnote,
	table.propdef-extra td.footnote,
	table.descdef td.footnote,
	table.definition-table td.footnote {
		padding-top: 0.6em;
	}
	table.propdef td.footnote::before,
	table.propdef-extra td.footnote::before,
	table.descdef td.footnote::before,
	table.definition-table td.footnote::before {
		content: " ";
		display: block;
		height: 0.6em;
		width: 4em;
		border-top: thin solid;
	}

/** Profile Tables ************************************************************/
	/* table of required features in a CSS profile */

	table.features th {
		background: #00589f;
		color: #fff;
		text-align: left;
		padding: 0.2em 0.2em 0.2em 0.5em;
	}
	table.features td {
		vertical-align: top;
		border-bottom: 1px solid #ccc;
		padding: 0.3em 0.3em 0.3em 0.7em;
	}

/** Data tables (and properly marked-up proptables) ***************************/
	/*
		 <table class="data"> highlights structural relationships in a table
		 when correct markup is used (e.g. thead/tbody, th vs. td, scope attribute)

		 Use class="complex data" for particularly complicated tables --
		 (This will draw more lines: busier, but clearer.)

		 Use class="long" on table cells with paragraph-like contents
		 (This will adjust text alignment accordingly.)
	*/

	.data, .proptable {
		margin: 1em auto;
		border-collapse: collapse;
		width: 100%;
		border: hidden;
	}
	.data {
		text-align: center;
		width: auto;
	}
	.data caption {
		width: 100%;
	}

	.data td, .data th,
	.proptable td, .proptable th {
		padding: 0.5em;
		border-width: 1px;
		border-color: silver;
		border-top-style: solid;
	}

	.data thead td:empty {
		padding: 0;
		border: 0;
	}

	.data thead th[scope="row"],
	.proptable thead th[scope="row"] {
		text-align: right;
		color: inherit;
	}

	.data thead,
	.proptable thead,
	.data tbody,
	.proptable tbody {
		color: inherit;
		border-bottom: 2px solid;
	}

	.data colgroup {
		border-left: 2px solid;
	}

	.data tbody th:first-child,
	.proptable tbody th:first-child ,
	.data tbody td[scope="row"]:first-child,
	.proptable tbody td[scope="row"]:first-child {
		text-align: right;
		color: inherit;
		border-right: 2px solid;
		border-top: 1px solid silver;
		padding-right: 1em;
	}
	.data.define td:last-child {
		text-align: left;
	}

	.data tbody th[rowspan],
	.proptable tbody th[rowspan],
	.data tbody td[rowspan],
	.proptable tbody td[rowspan]{
		border-left:  1px solid silver;
		border-right: 1px solid silver;
	}

	.complex.data th,
	.complex.data td {
		border: 1px solid silver;
	}

	.data td.long {
	 vertical-align: baseline;
	 text-align: left;
	}

	.data img {
		vertical-align: middle;
	}


/******************************************************************************/
/*                                  Indices                                   */
/******************************************************************************/


/** Table of Contents *********************************************************/

	/* ToC not indented, but font style shows hierarchy */
	ul.toc           { margin: 1em 0;     font-weight: bold; /*text-transform: uppercase;*/ }
	ul.toc ul        { margin: 0;        font-weight: normal; text-transform: none; }
	ul.toc ul ul     { margin: 0 0 0 2em; font-style: italic; }
	ul.toc ul ul ul  { margin: 0; }
	ul.toc > li      { margin: 1.5em 0; }
	ul.toc ul.toc li { margin: 0.3em 0 0 0; }

	ul.toc, ul.toc ul, ul.toc li { padding: 0; line-height: 1.3; }
	ul.toc a { text-decoration: none; border-bottom-style: none; }
	ul.toc a:hover, ul.toc a:focus  { border-bottom-style: solid; }
	@supports (text-decoration-style: solid) {
		ul.toc a:hover, ul.toc a:focus  {
			border-bottom-style: none;
			text-decoration-style: solid;
		}
	}
	/*
	ul.toc li li li, ul.toc li li li ul {margin-left: 0; display: inline}
	ul.toc li li li ul, ul.toc li li li ul li {margin-left: 0; display: inline}
	*/

	/* Section numbers in a column of their own */
	ul.toc {
		margin-left: 5em
	}
	ul.toc span.secno {
		float: left;
		width: 4em;
		margin-left: -5em;
	}
	ul.toc ul ul span.secno {
		margin-left: -7em;
	}
	/*ul.toc span.secno {text-align: right}*/
	ul.toc li {
		clear: both;
	}
	/* If we had 'tab', floats would not be needed here:
		 ul.toc span.secno {tab: 5em right; margin-right: 1em}
		 ul.toc li {text-indent: 5em hanging}
	 The second line in case items wrap
	*/

/** At-risk List **************************************************************/
	/* Style for At Risk features (intended as editorial aid, not intended for publishing) */

	.atrisk::before {
	 float: right;
	 margin-top: -0.25em;
	 padding: 0.5em 1em 0.5em 0;
	 text-indent: -0.9em;
	 border: 1px solid;
	 content: '\25C0    Not yet widely implemented';
	 white-space: pre;
	 font-size: small;
	 background-color: white;
	 color: gray;
	 text-align: center;
	}

	.toc .atrisk::before { content:none }

/** Index *********************************************************************/

	/* Index Lists: Layout */
	ul.indexlist       { margin-left: 0; columns: 15em; -webkit-columns: 15em; text-indent: 1em hanging; }
	ul.indexlist li    { margin-left: 0; list-style: none; break-inside: avoid; word-break: break-word; }
	ul.indexlist li li { margin-left: 1em }
	ul.indexlist dl    { margin-top: 0; }
	ul.indexlist dt    { margin: .2em 0 .2em 20px;}
	ul.indexlist dd    { margin: .2em 0 .2em 40px;}
	/* Index Lists: Typography */
	ul.indexlist ul,
	ul.indexlist dl { font-size: smaller; }
	ul.indexlist li span {
		white-space: nowrap;
		position: absolute;
		color: transparent; }
	ul.indexlist li a:hover + span,
	ul.indexlist li a:focus + span {
		color: gray;
	}
	@media print {
		ul.indexlist li span { color: gray; }
	}

/** Property Index Tables *****************************************************/
	/* See also the data table styling section, which this effectively subclasses */

	table.proptable {
		font-size: small;
		border-collapse: collapse;
		border-spacing: 0;
		text-align: left;
		margin: 1em 0;
	}

	table.proptable td,
	table.proptable th {
		padding: 0.4em;
		text-align: center;
	}

	table.proptable tr:hover td {
		background: #DEF;
	}
	.propdef th {
		font-style: italic;
		font-weight: normal;
		text-align: left;
		width: 3em;
	}
	/* The link in the first column in the property table (formerly a TD) */
	table.proptable td .property,
	table.proptable th .property {
		display: block;
		text-align: left;
		font-weight: bold;
	}

/******************************************************************************/
/*                                    Print                                   */
/******************************************************************************/

	@media print {
		html {
			margin: 0 !important; }
		body {
			font-family: serif; }
		th, td {
			font-family: inherit; }
		a {
			color: inherit !important; }

		a:link, a:visited {
			text-decoration: none !important }
		a:link::after, a:visited::after { /* create a cross-ref "see..." */ }
		.example::before {
			font-family: serif !important; }
	}
	@page {
		margin: 1.5cm 1.1cm;
	}

</style>
  <meta content="Bikeshed 1.0.0" name="generator">
 </head>
 <body class="h-entry">
  <div class="head">
   <p data-fill-with="logo"><a class="logo" href="http://www.w3.org/"> <img alt="W3C" height="48" src="https://www.w3.org/Icons/w3c_home" width="72"> </a> </p>
   <h1 class="p-name no-ref" id="title">Geofencing API</h1>
   <h2 class="no-num no-toc no-ref heading settled" id="subtitle"><span class="content">Editor’s Draft, <time class="dt-updated" datetime="2015-10-02">2 October 2015</time></span></h2>
   <div data-fill-with="spec-metadata">
    <dl>
     <dt>This version:
     <dd><a class="u-url" href="https://w3c.github.io/geofencing-api/">https://w3c.github.io/geofencing-api/</a>
     <dt>Latest version:
     <dd><a href="http://www.w3.org/TR/geofencing/">http://www.w3.org/TR/geofencing/</a>
     <dt>Feedback:
     <dd><span><a href="mailto:public-geolocation@w3.org?subject=%5Bgeofencing-api%5D%20YOUR%20TOPIC%20HERE">public-geolocation@w3.org</a> with subject line “<kbd>[geofencing-api] <var>… message topic …</var></kbd>” (<a href="http://lists.w3.org/Archives/Public/public-geolocation/" rel="discussion">archives</a>)</span>
     <dt>Issue Tracking:
     <dd><a href="https://github.com/w3c/geofencing-api/issues/">GitHub</a>
     <dt class="editor">Editor:
     <dd class="editor p-author h-card vcard"><a class="p-name fn u-email email" href="mailto:mek@chromium.org">Marijn Kruisselbrink</a> (<span class="p-org org">Google</span>)
    </dl>
   </div>
   <div data-fill-with="warning"></div>
   <p class="copyright" data-fill-with="copyright"><a href="http://www.w3.org/Consortium/Legal/ipr-notice#Copyright">Copyright</a> © 2015 <a href="http://www.w3.org/"><abbr title="World Wide Web Consortium">W3C</abbr></a><sup>®</sup> (<a href="http://www.csail.mit.edu/"><abbr title="Massachusetts Institute of Technology">MIT</abbr></a>, <a href="http://www.ercim.eu/"><abbr title="European Research Consortium for Informatics and Mathematics">ERCIM</abbr></a>, <a href="http://www.keio.ac.jp/">Keio</a>, <a href="http://ev.buaa.edu.cn/">Beihang</a>). W3C <a href="http://www.w3.org/Consortium/Legal/ipr-notice#Legal_Disclaimer">liability</a>, <a href="http://www.w3.org/Consortium/Legal/ipr-notice#W3C_Trademarks">trademark</a> and <a href="http://www.w3.org/Consortium/Legal/copyright-documents">document use</a> rules apply. </p>
   <hr title="Separator for header">
  </div>
  <h2 class="no-num no-toc no-ref heading settled" id="abstract"><span class="content">Abstract</span></h2>
  <div class="p-summary" data-fill-with="abstract">
   <p>This specification defines an API that lets <a data-link-type="dfn" href="#webapp" title="webapp">webapps</a> setup geographic boundaries around specific locations and then receive notifications when the hosting device enters or leaves those areas.</p>
  </div>
  <h2 class="no-num no-toc no-ref heading settled" id="status"><span class="content">Status of this document</span></h2>
  <div data-fill-with="status">
   <p> <em>This section describes the status of this document at the time of its publication. Other documents may supersede this document. A list of current <abbr title="World Wide Web Consortium">W3C</abbr> publications and the latest revision of this technical report can be found in the <a href="http://www.w3.org/TR/"><abbr title="World Wide Web Consortium">W3C</abbr> technical reports index</a> at http://www.w3.org/TR/.</em> </p>
   <p> This document was published by the <a href="http://www.w3.org/2008/geolocation/">Geolocation Working Group</a> as an Editor’s Draft.          
  If you wish to make comments regarding this document, please send them to <a href="mailto:public-geolocation@w3.org?subject=%5Bgeofencing-api%5D%20PUT%20SUBJECT%20HERE">public-geolocation@w3.org</a> (<a href="mailto:public-geolocation-request@w3.org?subject=subscribe">subscribe</a>, <a href="http://lists.w3.org/Archives/Public/public-geolocation/">archives</a>)
  with <code>[geofencing-api]</code> at the start of your email’s subject.
  All comments are welcome. </p>
   <p> Publication as an Editor’s Draft does not imply endorsement by the <abbr title="World Wide Web Consortium">W3C</abbr> Membership. This is a draft document and may be updated, replaced or obsoleted by other
  documents at any time. It is inappropriate to cite this document as other than work in
  progress. </p>
   <p> This document was produced by a group operating under
        the <a href="http://www.w3.org/Consortium/Patent-Policy-20040205/">5 February 2004 W3C Patent Policy</a>.
        W3C maintains a <a href="http://www.w3.org/2004/01/pp-impl/49309/status" rel="disclosure">public list of any patent disclosures</a> made in connection with the deliverables of the group;
        that page also includes instructions for disclosing a patent.
        An individual who has actual knowledge of a patent which the individual believes contains <a href="http://www.w3.org/Consortium/Patent-Policy-20040205/#def-essential">Essential Claim(s)</a> must disclose the information in accordance with <a href="http://www.w3.org/Consortium/Patent-Policy-20040205/#sec-Disclosure">section 6 of the W3C Patent Policy</a>. </p>
   <p> This document is governed by the <a href="http://www.w3.org/2015/Process-20150901/" id="w3c_process_revision">1 September 2015 <abbr title="World Wide Web Consortium">W3C</abbr> Process Document</a>. </p>
   <p></p>
  </div>
  <div data-fill-with="at-risk"></div>
  <h2 class="no-num no-toc no-ref heading settled" id="contents"><span class="content">Table of Contents</span></h2>
  <div data-fill-with="table-of-contents" role="navigation">
   <ul class="toc" role="directory">
    <li>
     <a href="#introduction"><span class="secno">1</span> <span class="content">Introduction</span></a>
     <ul class="toc">
      <li>
       <a href="#examples"><span class="secno">1.1</span> <span class="content">Examples</span></a>
       <ul class="toc">
        <li><a href="#example-monitor-a-region"><span class="secno">1.1.1</span> <span class="content">Monitor a region</span></a>
        <li><a href="#example-respond-to-enter"><span class="secno">1.1.2</span> <span class="content">Respond to a region being entered</span></a>
        <li><a href="#example-respond-to-error"><span class="secno">1.1.3</span> <span class="content">Respond to an error condition</span></a>
        <li><a href="#example-unmonitor"><span class="secno">1.1.4</span> <span class="content">Unmonitor a region in response to some other event</span></a>
       </ul>
     </ul>
    <li>
     <a href="#model"><span class="secno">2</span> <span class="content">Model</span></a>
     <ul class="toc">
      <li><a href="#implementation considerations"><span class="secno">2.1</span> <span class="content">Implementation considerations</span></a>
     </ul>
    <li>
     <a href="#security-and-privacy-considerations"><span class="secno">3</span> <span class="content">Security and privacy considerations</span></a>
     <ul class="toc">
      <li><a href="#privacy-considerations-for-implementers-of-the-geofencing-api"><span class="secno">3.1</span> <span class="content"> Privacy considerations for implementers of the Geofencing API </span></a>
      <li><a href="#privacy-considerations-for-recipients-of-location-information"><span class="secno">3.2</span> <span class="content"> Privacy considerations for recipients of location information </span></a>
      <li><a href="#additional-implementation-considerations"><span class="secno">3.3</span> <span class="content"> Additional implementation considerations </span></a>
     </ul>
    <li>
     <a href="#api-description"><span class="secno">4</span> <span class="content">API Description</span></a>
     <ul class="toc">
      <li><a href="#extensions-to-the-serviceworkerregistration-interface"><span class="secno">4.1</span> <span class="content"> Extensions to the <code class="idl"><span>ServiceWorkerRegistration</span></code> interface </span></a>
      <li><a href="#geofencemanager-interface"><span class="secno">4.2</span> <span class="content"><code class="idl"><span>GeofenceManager</span></code> interface</span></a>
      <li><a href="#geofence-interface"><span class="secno">4.3</span> <span class="content"><code class="idl"><span>Geofence</span></code> interface</span></a>
      <li><a href="#geofenceregion-interface"><span class="secno">4.4</span> <span class="content"><code class="idl"><span>GeofenceRegion</span></code> interface</span></a>
      <li><a href="#circulargeofenceregion-interface"><span class="secno">4.5</span> <span class="content"><code class="idl"><span>CircularGeofenceRegion</span></code> interface</span></a>
      <li>
       <a href="#events"><span class="secno">4.6</span> <span class="content">Events</span></a>
       <ul class="toc">
        <li><a href="#the-geofenceenter-and-geofenceleave-events"><span class="secno">4.6.1</span> <span class="content"> The <code>geofenceenter</code> and <code>geofenceleave</code> events </span></a>
        <li><a href="#geofenceerrorevent-section"><span class="secno">4.6.2</span> <span class="content"><code class="idl"><span>GeofenceErrorEvent</span></code></span></a>
       </ul>
     </ul>
    <li><a href="#exceptions"><span class="secno">5</span> <span class="content">Exceptions</span></a>
    <li>
     <a href="#conformance"><span class="secno"></span> <span class="content">Conformance</span></a>
     <ul class="toc">
      <li><a href="#conventions"><span class="secno"></span> <span class="content">Document conventions</span></a>
      <li><a href="#conformant-algorithms"><span class="secno"></span> <span class="content">Conformant Algorithms</span></a>
     </ul>
    <li>
     <a href="#index"><span class="secno"></span> <span class="content">Index</span></a>
     <ul class="toc">
      <li><a href="#index-defined-here"><span class="secno"></span> <span class="content">Terms defined by this specification</span></a>
      <li><a href="#index-defined-elsewhere"><span class="secno"></span> <span class="content">Terms defined by reference</span></a>
     </ul>
    <li>
     <a href="#references"><span class="secno"></span> <span class="content">References</span></a>
     <ul class="toc">
      <li><a href="#normative"><span class="secno"></span> <span class="content">Normative References</span></a>
     </ul>
    <li><a href="#idl-index"><span class="secno"></span> <span class="content">IDL Index</span></a>
    <li><a href="#issues-index"><span class="secno"></span> <span class="content">Issues Index</span></a>
   </ul>
  </div>
  <main>
   <section>
    <h2 class="heading settled" data-level="1" id="introduction"><span class="secno">1. </span><span class="content">Introduction</span><a class="self-link" href="#introduction"></a></h2>
    <p><em>This section is non-normative.</em></p>
    <p>The Geofencing API lets <a data-link-type="dfn" href="#webapp" title="webapp">webapps</a> setup geographic boundaries around
  specific locations and then receive notifications when the hosting device enters or leaves
  those areas. While it would be possible to implement something similar using the
  Geolocation API <a data-link-type="biblio" href="#biblio-geolocation-api">[GEOLOCATION-API]</a>, there are a few differences that could make this API
  a better choice:</p>
    <ul>
     <li data-md="">
      <p>Because of the limited API surface of the Geofencing API, <a data-link-type="dfn" href="#user-agent">user
agents</a> can implement the API in a more (power) efficient way than could be achieved by
regularly checking the current geographic position with the Geolocation API.</p>
     <li data-md="">
      <p>The Geofencing API is built around Service Workers. This makes it possible for a <a data-link-type="dfn" href="#webapp">webapp</a> to receive notifications from the Geofencing API even after the user has
closed the <a data-link-type="dfn" href="#webapp">webapp</a>.</p>
    </ul>
    <section>
     <h3 class="heading settled" data-level="1.1" id="examples"><span class="secno">1.1. </span><span class="content">Examples</span><a class="self-link" href="#examples"></a></h3>
     <p>The following code extracts illustrate how to use this API to be notified of geographic
    regions being entered or left.</p>
     <section>
      <h4 class="heading settled" data-level="1.1.1" id="example-monitor-a-region"><span class="secno">1.1.1. </span><span class="content">Monitor a region</span><a class="self-link" href="#example-monitor-a-region"></a></h4>
<pre class="example highlight" id="example-89fd9b0d"><a class="self-link" href="#example-89fd9b0d"></a>// https://example.com/webapp.js
navigator.serviceWorker
  .register('serviceworker.js')
  .then((swRegistration) => {
    let region = new CircularGeofenceRegion({
      name: 'myfence',
      latitude: 37.421999,
      longitude: -122.084015,
      radius: 1000
    });
    let options = {
      includePosition: true
    };
    swRegistration.geofencing.add(region, options)
      .then(
        // If more than just a name needs to be stored with a geofence, now
        // would be the time to store this in some storage.
        (geofence) => console.log(geofence.id),
        (error) => console.log(error)
      );
});
</pre>
     </section>
     <section>
      <h4 class="heading settled" data-level="1.1.2" id="example-respond-to-enter"><span class="secno">1.1.2. </span><span class="content">Respond to a region being entered</span><a class="self-link" href="#example-respond-to-enter"></a></h4>
<pre class="example highlight" id="example-21ad8310"><a class="self-link" href="#example-21ad8310"></a>// https://example.com/serviceworker.js
self.ongeofenceenter = (event) => {
  console.log(event.geofence.id);
  console.log(event.geofence.region.name);

  // If this is not a geofence of interest anymore, remove it.
  if (event.geofence.region.name !== "myfence") {
    event.waitUntil(event.geofence.remove());
  }
};
</pre>
     </section>
     <section>
      <h4 class="heading settled" data-level="1.1.3" id="example-respond-to-error"><span class="secno">1.1.3. </span><span class="content">Respond to an error condition</span><a class="self-link" href="#example-respond-to-error"></a></h4>
<pre class="example highlight" id="example-24ab4d23"><a class="self-link" href="#example-24ab4d23"></a>// https://example.com/serviceworker.js
self.ongeofenceerror = (event) => {
  console.log(event.geofence.id);
  console.log(event.geofence.region.name);
  console.log(event.error);

  // Some error condition occurred. The region is no longer monitored, and won’t
  // trigger any more events.

  // Try to re-monitor, although depending on the error this might fail.
  event
    .waitUntil(self.registration.geofencing.add(event.geofence.region))
    .then((geofence) => {
      // re-monitoring succeeded, new geofence will have a different ID.
    }, (error) => {
      // re-monitoring failed.
    });
};
</pre>
     </section>
     <section>
      <h4 class="heading settled" data-level="1.1.4" id="example-unmonitor"><span class="secno">1.1.4. </span><span class="content">Unmonitor a region in response to some other event</span><a class="self-link" href="#example-unmonitor"></a></h4>
<pre class="example highlight" id="example-48aef5ac"><a class="self-link" href="#example-48aef5ac"></a>// https://example.com/serviceworker.js

// Either look geofence up by name:
self.onsomeevent = (event) => {
  event
    .waitUntil(
      self.registration.geofencing.getAll({
        name: 'myfence'
      })
    )
    .then(
      geofences => geofences.forEach(fence => fence.remove())
    );
};

// Or look geofence up by ID:
self.onsomeotherevent = (event) => {
  let geofence_id = ''; /* somehow get the ID of a geofence */
  event
    .waitUntil(self.registration.geofencing.getById(geofence_id))
    .then(geofence => geofence.remove());
};
</pre>
     </section>
    </section>
   </section>
   <section>
    <h2 class="heading settled" data-level="2" id="model"><span class="secno">2. </span><span class="content">Model</span><a class="self-link" href="#model"></a></h2>
    <p>The term <dfn data-dfn-type="dfn" data-noexport="" id="webapp">webapp<a class="self-link" href="#webapp"></a></dfn> refers to a Web application, i.e. an application implemented
  using Web technologies, and executing within the context of a Web <a data-link-type="dfn" href="#user-agent">user agent</a>, e.g. a
  Web browser or other Web runtime environment.</p>
    <p>A <a data-link-type="dfn" href="https://slightlyoff.github.io/ServiceWorker/spec/service_worker/index.html#service-worker-registration-concept">service worker registration</a> has an associated <dfn data-dfn-type="dfn" data-noexport="" id="list-of-geofences">list of geofences<a class="self-link" href="#list-of-geofences"></a></dfn> whose element
  type is a <a data-link-type="dfn" href="#geofence-term">geofence</a>.</p>
    <p>A <dfn data-dfn-type="dfn" data-noexport="" id="geofence-term">geofence<a class="self-link" href="#geofence-term"></a></dfn> is one specific registration of a geograhpic region as a geofence.</p>
    <p>A <a data-link-type="dfn" href="#geofence-term">geofence</a> has a <dfn data-dfn-type="dfn" data-lt="geofence name" data-noexport="" id="geofence-name">name<a class="self-link" href="#geofence-name"></a></dfn> (a string).</p>
    <p>A <a data-link-type="dfn" href="#geofence-term">geofence</a> has an associated <a data-link-type="dfn" href="#geographic-region">geographic region</a>.</p>
    <p>A <a data-link-type="dfn" href="#geofence-term">geofence</a> has a <dfn data-dfn-type="dfn" data-noexport="" id="geofence-id">geofence ID<a class="self-link" href="#geofence-id"></a></dfn>, a string uniquely identifying it. This ID is
  generated by the user agent and MUST be unique among all <a data-link-type="dfn" href="#list-of-geofences">geofences</a> associated with all <a data-link-type="dfn" href="https://slightlyoff.github.io/ServiceWorker/spec/service_worker/index.html#service-worker-registration-concept">service worker registrations</a> at the
  same origin. A user agent SHOULD NOT reuse the ID from an old <a data-link-type="dfn" href="#geofence-term">geofence</a> for a new
  one.</p>
    <p>A <a data-link-type="dfn" href="#geofence-term">geofence</a> has a <dfn data-dfn-type="dfn" data-noexport="" id="include-position">include position<a class="self-link" href="#include-position"></a></dfn> flag, a boolean indicating if events
  associated with this <a data-link-type="dfn" href="#geofence-term">geofence</a> should include the exact geographic position.</p>
    <p>A <a data-link-type="dfn" href="#geofence-term">geofence</a> has an associated <dfn data-dfn-type="dfn" data-noexport="" id="state">state<a class="self-link" href="#state"></a></dfn>, which is one of <dfn data-dfn-type="dfn" data-noexport="" id="active">active<a class="self-link" href="#active"></a></dfn> or <dfn data-dfn-type="dfn" data-noexport="" id="inactive">inactive<a class="self-link" href="#inactive"></a></dfn>.</p>
    <p>The <a data-link-type="dfn" href="#user-agent">user agent</a> SHOULD be monitoring all <a data-link-type="dfn" href="#active">active</a> <a data-link-type="dfn" href="#geofence-term">geofences</a> for <a data-link-type="dfn" href="#breached">breach</a> events.</p>
    <p>A <dfn data-dfn-type="dfn" data-noexport="" id="geographic-region">geographic region<a class="self-link" href="#geographic-region"></a></dfn> is a circular region defined by a <a data-link-type="dfn" href="#geographic-coordinate">geographic
  coordinate</a> representing the center of the region and a <dfn data-dfn-type="dfn" data-noexport="" id="radius">radius<a class="self-link" href="#radius"></a></dfn> representing
  the size of the region.</p>
    <p>The <dfn data-dfn-type="dfn" data-noexport="" id="geographic-coordinate">geographic coordinate<a class="self-link" href="#geographic-coordinate"></a></dfn> reference system used by the attributes in this API is
  the World Geodetic System (2d) <a data-link-type="biblio" href="#biblio-wgs84">[WGS84]</a>. No other reference system is supported.</p>
    <p>A <a data-link-type="dfn" href="#geofence-term">geofence</a> is said to be <dfn data-dfn-type="dfn" data-noexport="" id="breached">breached<a class="self-link" href="#breached"></a></dfn> if the current geographical location
  changed from being inside the <a data-link-type="dfn" href="#geographic-region">geographic region</a> to outside (a <dfn data-dfn-type="dfn" data-noexport="" id="leave-event">leave
  event<a class="self-link" href="#leave-event"></a></dfn>), or vice versa (an <dfn data-dfn-type="dfn" data-noexport="" id="enter-event">enter event<a class="self-link" href="#enter-event"></a></dfn>).</p>
    <section>
     <h3 class="heading settled" data-level="2.1" id="implementation considerations"><span class="secno">2.1. </span><span class="content">Implementation considerations</span><a class="self-link" href="#implementation%20considerations"></a></h3>
     <p>A <a data-link-type="dfn" href="#user-agent">user agent</a> MAY impose <dfn data-dfn-type="dfn" data-lt="name limit" data-noexport="" id="name-limit">limits<a class="self-link" href="#name-limit"></a></dfn> on the maximum size of a <a data-link-type="dfn" href="#geofence-name">geofence name</a>. If a limit is imposed, this limit SHOULD allow for at least 100 characters.</p>
     <p>A <a data-link-type="dfn" href="#user-agent">user agent</a> MAY impose <dfn data-dfn-type="dfn" data-lt="geofence limit" data-noexport="" id="geofence-limit">limits<a class="self-link" href="#geofence-limit"></a></dfn> on the total number of <a data-link-type="dfn" href="#list-of-geofences">geofences</a> that can be registered by a single origin. If a
    limit is imposed, this limit SHOULD allow at least 20 <a data-link-type="dfn" href="#list-of-geofences">geofences</a> to be registered on a single origin.</p>
    </section>
   </section>
   <section>
    <h2 class="heading settled" data-level="3" id="security-and-privacy-considerations"><span class="secno">3. </span><span class="content">Security and privacy considerations</span><a class="self-link" href="#security-and-privacy-considerations"></a></h2>
    <p>The same <a href="http://www.w3.org/TR/geolocation-API/#security">security and privacy
  considerations</a> that apply to the Geolocation API <a data-link-type="biblio" href="#biblio-geolocation-api">[GEOLOCATION-API]</a> also apply to
  this API. Furthermore since this API effectively gives access to geographic location
  information after a user has stopped interacting with a webapp, a few other considerations
  should be taken into account.</p>
    <section>
     <h3 class="heading settled" data-level="3.1" id="privacy-considerations-for-implementers-of-the-geofencing-api"><span class="secno">3.1. </span><span class="content"> Privacy considerations for implementers of the Geofencing API </span><a class="self-link" href="#privacy-considerations-for-implementers-of-the-geofencing-api"></a></h3>
     <p><a data-link-type="dfn" href="#user-agent">User agents</a> MUST NOT provide Geofencing API access to <a data-link-type="dfn" href="#webapp">webapps</a> without the express permission of the user. <a data-link-type="dfn" href="#user-agent">User agents</a> MUST acquire consent for permission through a user
    interface for each call to the <code class="idl"><a data-link-type="idl" href="#dom-geofencemanager-add">add(initialRegion, options)</a></code> method, unless a
    previous permission grant has been persisted, or a prearranged trust relationship applies.
    Permissions that are preserved beyond the current browsing session MUST be revocable.</p>
     <p>The <a data-link-type="dfn" href="#user-agent">user agent</a> MAY consider the <code class="idl"><a data-link-type="idl" href="#geofenceregion">GeofenceRegion</a></code> and/or the <code class="idl"><a data-link-type="idl" href="#dictdef-geofenceoptions">GeofenceOptions</a></code> when
    acquiring permission or determining the permission status.</p>
     <p>When a permission is revoked, all <a data-link-type="dfn" href="#geofence-term">geofences</a> added with that permission
    MUST be <a data-link-type="dfn" href="#deactivated">deactivated</a>.</p>
     <p>When permission is granted for unlimited use of the Geofencing API by a <a data-link-type="dfn" href="https://slightlyoff.github.io/ServiceWorker/spec/service_worker/index.html#service-worker-registration-concept">service worker
    registration</a>, the <a data-link-type="dfn" href="#state">state</a> of all associated <a data-link-type="dfn" href="#geofence-term">geofences</a> SHOULD
    be set to <a data-link-type="dfn" href="#active">active</a>, and the <a data-link-type="dfn" href="#user-agent">user agent</a> SHOULD start monitoring these <a data-link-type="dfn" href="#geofence-term">geofences</a> for <a data-link-type="dfn" href="#breached">breach</a> events.</p>
     <p>When a <a data-link-type="dfn" href="https://slightlyoff.github.io/ServiceWorker/spec/service_worker/index.html#service-worker-registration-concept">service worker registration</a> is unregistered, any associated <a data-link-type="dfn" href="#geofence-term">geofences</a> MUST be <a data-link-type="dfn" href="#deactivated">deactivated</a>.</p>
     <p><a data-link-type="dfn" href="#user-agent">User agents</a> MUST allow access to the Geofencing API from <a data-link-type="dfn" href="https://w3c.github.io/webappsec/specs/powerfulfeatures/#secure-context">secure contexts</a> only.</p>
     <p class="issue" id="issue-4cdf3c60"><a class="self-link" href="#issue-4cdf3c60"></a> This should somehow mention how the [permissions] API is related to this.</p>
    </section>
    <section>
     <h3 class="heading settled" data-level="3.2" id="privacy-considerations-for-recipients-of-location-information"><span class="secno">3.2. </span><span class="content"> Privacy considerations for recipients of location information </span><a class="self-link" href="#privacy-considerations-for-recipients-of-location-information"></a></h3>
     <p>TODO</p>
    </section>
    <section>
     <h3 class="heading settled" data-level="3.3" id="additional-implementation-considerations"><span class="secno">3.3. </span><span class="content"> Additional implementation considerations </span><a class="self-link" href="#additional-implementation-considerations"></a></h3>
     <p><em>This section is non-normative.</em></p>
     <p>TODO</p>
    </section>
   </section>
   <section>
    <h2 class="heading settled" data-level="4" id="api-description"><span class="secno">4. </span><span class="content">API Description</span><a class="self-link" href="#api-description"></a></h2>
    <section>
     <h3 class="heading settled" data-level="4.1" id="extensions-to-the-serviceworkerregistration-interface"><span class="secno">4.1. </span><span class="content"> Extensions to the <code class="idl"><a data-link-type="idl" href="https://slightlyoff.github.io/ServiceWorker/spec/service_worker/index.html#service-worker-registration-interface">ServiceWorkerRegistration</a></code> interface </span><a class="self-link" href="#extensions-to-the-serviceworkerregistration-interface"></a></h3>
     <p>The Service Worker specification defines a <code class="idl"><a data-link-type="idl" href="https://slightlyoff.github.io/ServiceWorker/spec/service_worker/index.html#service-worker-registration-interface">ServiceWorkerRegistration</a></code> interface, which
    this specification extends.</p>
<pre class="idl">partial interface <a class="idl-code" data-link-type="interface" href="https://slightlyoff.github.io/ServiceWorker/spec/service_worker/index.html#service-worker-registration-interface">ServiceWorkerRegistration</a> {
  readonly attribute <a data-link-type="idl-name" href="#geofencemanager">GeofenceManager</a> <dfn class="idl-code" data-dfn-for="ServiceWorkerRegistration" data-dfn-type="attribute" data-export="" data-readonly="" data-type="GeofenceManager " id="dom-serviceworkerregistration-geofencing">geofencing<a class="self-link" href="#dom-serviceworkerregistration-geofencing"></a></dfn>;
};
</pre>
    </section>
    <section>
     <h3 class="heading settled" data-level="4.2" id="geofencemanager-interface"><span class="secno">4.2. </span><span class="content"><code class="idl"><a data-link-type="idl" href="#geofencemanager">GeofenceManager</a></code> interface</span><a class="self-link" href="#geofencemanager-interface"></a></h3>
     <p>The <code class="idl"><a data-link-type="idl" href="#geofencemanager">GeofenceManager</a></code> interface defines operations that enable <a data-link-type="dfn" href="#webapp" title="webapp">webapps</a> to establish access to geofencing services.</p>
<pre class="idl">[NoInterfaceObject]
interface <dfn class="idl-code" data-dfn-type="interface" data-export="" id="geofencemanager">GeofenceManager<a class="self-link" href="#geofencemanager"></a></dfn> {
  Promise&lt;<a data-link-type="idl-name" href="#geofence">Geofence</a>> <a class="idl-code" data-link-type="method" href="#dom-geofencemanager-add">add</a>(<a data-link-type="idl-name" href="#geofenceregion">GeofenceRegion</a> <dfn class="idl-code" data-dfn-for="GeofenceManager/add(initialRegion, options), GeofenceManager/add(initialRegion)" data-dfn-type="argument" data-export="" id="dom-geofencemanager-add-initialregion-options-initialregion">initialRegion<a class="self-link" href="#dom-geofencemanager-add-initialregion-options-initialregion"></a></dfn>, optional <a data-link-type="idl-name" href="#dictdef-geofenceoptions">GeofenceOptions</a> <dfn class="idl-code" data-dfn-for="GeofenceManager/add(initialRegion, options), GeofenceManager/add(initialRegion)" data-dfn-type="argument" data-export="" id="dom-geofencemanager-add-initialregion-options-options">options<a class="self-link" href="#dom-geofencemanager-add-initialregion-options-options"></a></dfn>);
  Promise&lt;sequence&lt;<a data-link-type="idl-name" href="#geofence">Geofence</a>>> <a class="idl-code" data-link-type="method" href="#dom-geofencemanager-getall">getAll</a>(optional <a data-link-type="idl-name" href="#dictdef-geofencequeryoptions">GeofenceQueryOptions</a> <dfn class="idl-code" data-dfn-for="GeofenceManager/getAll(options), GeofenceManager/getAll()" data-dfn-type="argument" data-export="" id="dom-geofencemanager-getall-options-options">options<a class="self-link" href="#dom-geofencemanager-getall-options-options"></a></dfn>);
  Promise&lt;<a data-link-type="idl-name" href="#geofence">Geofence</a>> <a class="idl-code" data-link-type="method" href="#dom-geofencemanager-getbyid">getById</a>(DOMString <dfn class="idl-code" data-dfn-for="GeofenceManager/getById(id)" data-dfn-type="argument" data-export="" id="dom-geofencemanager-getbyid-id-id">id<a class="self-link" href="#dom-geofencemanager-getbyid-id-id"></a></dfn>);
};

dictionary <dfn class="idl-code" data-dfn-type="dictionary" data-export="" id="dictdef-geofenceoptions">GeofenceOptions<a class="self-link" href="#dictdef-geofenceoptions"></a></dfn> {
  boolean <a class="idl-code" data-default="false" data-link-type="dict-member" data-type="boolean " href="#dom-geofenceoptions-includeposition">includePosition</a> = false;
};

dictionary <dfn class="idl-code" data-dfn-type="dictionary" data-export="" id="dictdef-geofencequeryoptions">GeofenceQueryOptions<a class="self-link" href="#dictdef-geofencequeryoptions"></a></dfn> {
  DOMString? <dfn class="idl-code" data-dfn-for="GeofenceQueryOptions" data-dfn-type="dict-member" data-export="" data-type="DOMString? " id="dom-geofencequeryoptions-name">name<a class="self-link" href="#dom-geofencequeryoptions-name"></a></dfn>;
};
</pre>
     <p>A <code class="idl"><a data-link-type="idl" href="#geofencemanager">GeofenceManager</a></code> has an associated <a data-link-type="dfn" href="https://slightlyoff.github.io/ServiceWorker/spec/service_worker/index.html#service-worker-registration-concept">service worker registration</a>, represented by the <code class="idl"><a data-link-type="idl" href="https://slightlyoff.github.io/ServiceWorker/spec/service_worker/index.html#service-worker-registration-interface">ServiceWorkerRegistration</a></code> instance on which the <code class="idl"><a data-link-type="idl" href="#geofencemanager">GeofenceManager</a></code> was exposed.</p>
     <p>The <code><dfn class="idl-code" data-dfn-for="GeofenceManager" data-dfn-type="method" data-export="" data-lt="add(initialRegion, options)|add(initialRegion)" id="dom-geofencemanager-add" title="add(initialRegion, options)"> add(<var>initialRegion</var>, <var>options</var>)<a class="self-link" href="#dom-geofencemanager-add"></a></dfn></code> method when invoked MUST return <a data-link-type="dfn" href="https://www.w3.org/2001/tag/doc/promises-guide#a-new-promise">a new promise</a> <var>promise</var> and run the following steps <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/infrastructure.html#in-parallel">in parallel</a>:</p>
     <ol>
      <li> Let <var>serviceWorkerRegistration</var> be the <code class="idl"><a data-link-type="idl" href="#geofencemanager">GeofenceManager</a></code>'s associated <a data-link-type="dfn" href="https://slightlyoff.github.io/ServiceWorker/spec/service_worker/index.html#service-worker-registration-concept">service worker registration</a>. 
      <li> If <var>initialRegion</var> is not a <code class="idl"><a data-link-type="idl" href="#circulargeofenceregion">CircularGeofenceRegion</a></code> instance, <a data-link-type="dfn" href="https://www.w3.org/2001/tag/doc/promises-guide#reject-promise">reject</a> <var>promise</var> with a <code class="idl"><a data-link-type="idl" href="http://www.ecma-international.org/ecma-262/6.0/#sec-native-error-types-used-in-this-standard-typeerror">TypeError</a></code>. 
      <li> If the length of the <code class="idl"><a data-link-type="idl" href="#dom-geofenceregion-name">name</a></code> property of <var>initialRegion</var> exceeds a <a data-link-type="dfn" href="#user-agent">user agent</a> defined <a data-link-type="dfn" href="#name-limit">limit</a>, <a data-link-type="dfn" href="https://www.w3.org/2001/tag/doc/promises-guide#reject-promise">reject</a> <var>promise</var> with a <code class="idl"><a data-link-type="idl" href="http://www.ecma-international.org/ecma-262/6.0/#sec-native-error-types-used-in-this-standard-rangeerror">RangeError</a></code>. 
      <li> If the <code class="idl"><a data-link-type="idl" href="#dom-circulargeofenceregion-latitude">latitude</a></code> property of <var>initialRegion</var> is less than <code>-90</code> or greater than <code>90</code>, <a data-link-type="dfn" href="https://www.w3.org/2001/tag/doc/promises-guide#reject-promise">reject</a> <var>promise</var> with a <code class="idl"><a data-link-type="idl" href="http://www.ecma-international.org/ecma-262/6.0/#sec-native-error-types-used-in-this-standard-rangeerror">RangeError</a></code>. 
      <li> If the <code class="idl"><a data-link-type="idl" href="#dom-circulargeofenceregion-longitude">longitude</a></code> property of <var>initialRegion</var> is less
        than <code>-180</code> or greater than <code>180</code>, <a data-link-type="dfn" href="https://www.w3.org/2001/tag/doc/promises-guide#reject-promise">reject</a> <var>promise</var> with a <code class="idl"><a data-link-type="idl" href="http://www.ecma-international.org/ecma-262/6.0/#sec-native-error-types-used-in-this-standard-rangeerror">RangeError</a></code>. 
      <li> If the total number of <a data-link-type="dfn" href="#list-of-geofences">geofences</a> for all <a data-link-type="dfn" href="https://slightlyoff.github.io/ServiceWorker/spec/service_worker/index.html#service-worker-registration-concept">service worker registrations</a> in the current origin
        is more than the <a data-link-type="dfn" href="#user-agent">user agent</a> defined <a data-link-type="dfn" href="#geofence-limit">limit</a>, <a data-link-type="dfn" href="https://www.w3.org/2001/tag/doc/promises-guide#reject-promise">reject</a> <var>promise</var> with a <code class="idl"><a data-link-type="idl" href="https://heycam.github.io/webidl/#quotaexceedederror">QuotaExceededError</a></code> and terminate these substeps. 
      <li> Let <var>geofence</var> be a new <a data-link-type="dfn" href="#geofence-term">geofence</a>. 
      <li> Set the <a data-link-type="dfn" href="#geofence-id">geofence ID</a> of <var>geofence</var> to a newly generated value. 
      <li> Set the <a data-link-type="dfn" href="#geographic-region">geographic region</a> of <var>geofence</var> to a
        the region represented by <var>initialRegion</var>. 
      <li> Set the <a data-link-type="dfn" href="#include-position">include position</a> flag of <var>geofence</var> to <var>options.includePosition</var>, or <code>false</code> if no options were
        specified. 
      <li> Set the <a data-link-type="dfn" href="#state">state</a> of <var>geofence</var> to <a data-link-type="dfn" href="#inactive">inactive</a>. 
      <li> Add <var>geofence</var> to the <a data-link-type="dfn" href="#list-of-geofences">list of geofences</a> associated with <var>serviceWorkerRegistration</var>. 
      <li> <a data-link-type="dfn" href="https://www.w3.org/2001/tag/doc/promises-guide#resolve-promise">Resolve</a> <var>promise</var> with a new <code class="idl"><a data-link-type="idl" href="#geofence">Geofence</a></code> instance representing <var>geofence</var>. 
      <li> Ask the user whether they allow the <a data-link-type="dfn" href="#webapp">webapp</a> to monitor geofences, unless a
        prearranged trust relationship applies or the user has already granted or denied
        permission explicitly for this <a data-link-type="dfn" href="#webapp">webapp</a>. 
      <li>
        If permission is not granted, invoke the <a data-link-type="dfn" href="https://slightlyoff.github.io/ServiceWorker/spec/service_worker/index.html#handle-functional-event-algorithm">Handle Functional Event</a> algorithm with <var>serviceWorkerRegistration</var> and the algorithm represented by
        the following substeps as arguments. 
       <ol>
        <li> Let <var>globalObject</var> be the <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/webappapis.html#global-object">global object</a> these steps are invoked with. 
        <li> Create a <a data-link-type="dfn" href="https://html.spec.whatwg.org/#concept-events-trusted">trusted</a> event <var>event</var> that uses the <code class="idl"><a data-link-type="idl" href="#geofenceerrorevent">GeofenceErrorEvent</a></code> interface, with event type <code><a data-link-type="dfn" href="#geofenceerror">geofenceerror</a></code>. 
        <li> Let the <code class="idl"><a data-link-type="idl" href="#dom-geofenceerrorevent-geofence">geofence</a></code> atrribute of <var>event</var> be initialized to
            a new <code class="idl"><a data-link-type="idl" href="#geofence">Geofence</a></code> instance representing <var>geofence</var>. 
        <li> Let the <code class="idl"><a data-link-type="idl" href="#dom-geofenceerrorevent-error">error</a></code> attribute of <var>event</var> be initialized to <code class="idl"><a data-link-type="idl" href="#exceptdef-permissiondeniederror">PermissionDeniedError</a></code>. 
        <li> Dispatch <var>event</var> at <var>globalObject</var>. 
       </ol>
      <li>
        Else if permission is granted, run the following substeps: 
       <ol>
        <li> Set the <a data-link-type="dfn" href="#state">state</a> of <var>geofence</var> to <a data-link-type="dfn" href="#active">active</a> and start monitoring the
            geofence for <a data-link-type="dfn" href="#breached">breach</a> events. 
        <li> If the current geographic position is inside the newly added region, <a data-link-type="dfn" href="#fire-a-geofence-event">fire a geofenceenter event</a>. 
       </ol>
     </ol>
     <p class="issue" id="issue-8ae02316"><a class="self-link" href="#issue-8ae02316"></a> Somehow mention that the region that is saved as part of the registration can be slightly
    different from the region passed to register. An implementation may adjust parameters to
    be in range of what is possible, or otherwise modify the region.</p>
     <p>If the <code><dfn class="idl-code" data-dfn-for="GeofenceOptions" data-dfn-type="dict-member" data-export="" id="dom-geofenceoptions-includeposition" title="includePosition">includePosition<a class="self-link" href="#dom-geofenceoptions-includeposition"></a></dfn></code> attribute is set to true, <code class="idl"><a data-link-type="idl" href="#geofenceevent">GeofenceEvent</a></code>s for this registration will have a <code class="idl"><a data-link-type="idl" href="#dom-geofenceevent-position">position</a></code> attribute. When set to false, the <code class="idl"><a data-link-type="idl" href="#dom-geofenceevent-position">position</a></code> attribute will always be undefined.</p>
     <p>The <code><dfn class="idl-code" data-dfn-for="GeofenceManager" data-dfn-type="method" data-export="" data-lt="getAll(options)|getAll()" id="dom-geofencemanager-getall" titlt="getAll(options)">getAll(<var>options</var>)<a class="self-link" href="#dom-geofencemanager-getall"></a></dfn></code> method when invoked MUST return <a data-link-type="dfn" href="https://www.w3.org/2001/tag/doc/promises-guide#a-new-promise">a new promise</a> <var>promise</var> and run the following steps <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/infrastructure.html#in-parallel">in parallel</a>:</p>
     <ol>
      <li> Let <var>geofences</var> be a new <code class="idl"><a data-link-type="idl" href="https://heycam.github.io/webidl/#idl-sequence">sequence</a></code>. 
      <li>
        For each <var>geofence</var> <a data-link-type="dfn" href="#geofence-term">geofence</a> in the <a data-link-type="dfn" href="#list-of-geofences">list of geofences</a> associated
        with this <a data-link-type="dfn" href="https://slightlyoff.github.io/ServiceWorker/spec/service_worker/index.html#service-worker-registration-concept">service worker registration</a>, run the following substeps: 
       <ol>
        <li> If <var>options</var> is passed, has a non-null <var>name</var> attribute,
            and that <var>name</var> is not equal to the <a data-link-type="dfn" href="#geofence-name">name</a> of the <var>geofence</var>, skip the rest of these substeps and continue with the next registration. 
        <li> Append a new <code class="idl"><a data-link-type="idl" href="#geofence">Geofence</a></code> instance representing <var>geofence</var> to <var>geofences</var>. 
       </ol>
      <li> <a data-link-type="dfn" href="https://www.w3.org/2001/tag/doc/promises-guide#resolve-promise">Resolve</a> <var>promise</var> with <var>geofences</var>. 
     </ol>
     <p>The <code><dfn class="idl-code" data-dfn-for="GeofenceManager" data-dfn-type="method" data-export="" id="dom-geofencemanager-getbyid" title="getById(id)">getById(<var>id</var>)<a class="self-link" href="#dom-geofencemanager-getbyid"></a></dfn></code> method when invoked MUST return <a data-link-type="dfn" href="https://www.w3.org/2001/tag/doc/promises-guide#a-new-promise">a new promise</a> <var>promise</var> and run the following
    steps <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/infrastructure.html#in-parallel">in parallel</a>:</p>
     <ol>
      <li>
        For each <var>geofence</var> <a data-link-type="dfn" href="#geofence-term">geofence</a> in the <a data-link-type="dfn" href="#list-of-geofences">list of geofences</a> associated
        with this <a data-link-type="dfn" href="https://slightlyoff.github.io/ServiceWorker/spec/service_worker/index.html#service-worker-registration-concept">service worker registration</a>, run the following substeps: 
       <ol>
        <li> If the <a data-link-type="dfn" href="#geofence-id">geofence ID</a> of <var>geofence</var> is not equal to
            the passed in <var>id</var>, skip the rest of these substeps and continue with
            the next geofence. 
        <li> <a data-link-type="dfn" href="https://www.w3.org/2001/tag/doc/promises-guide#resolve-promise">Resolve</a> <var>promise</var> with a new <code class="idl"><a data-link-type="idl" href="#geofence">Geofence</a></code> instance representing <var>geofence</var>. 
       </ol>
      <li> If <var>promise</var> was not resolved, <a data-link-type="dfn" href="https://www.w3.org/2001/tag/doc/promises-guide#resolve-promise">resolve</a> <var>promise</var> with <code>null</code>. 
     </ol>
    </section>
    <section>
     <h3 class="heading settled" data-level="4.3" id="geofence-interface"><span class="secno">4.3. </span><span class="content"><code class="idl"><a data-link-type="idl" href="#geofence">Geofence</a></code> interface</span><a class="self-link" href="#geofence-interface"></a></h3>
     <p>An instance of the <code class="idl"><a data-link-type="idl" href="#geofence">Geofence</a></code> interface represents a <a data-link-type="dfn" href="#geofence-term">geofence</a>.</p>
<pre class="idl">[Exposed=(Window,Worker)]
interface <dfn class="idl-code" data-dfn-type="interface" data-export="" id="geofence">Geofence<a class="self-link" href="#geofence"></a></dfn> {
  readonly attribute DOMString <a class="idl-code" data-link-type="attribute" data-readonly="" data-type="DOMString " href="#dom-geofence-id">id</a>;
  readonly attribute <a data-link-type="idl-name" href="#geofenceregion">GeofenceRegion</a> <a class="idl-code" data-link-type="attribute" data-readonly="" data-type="GeofenceRegion " href="#dom-geofence-region">region</a>;
  Promise&lt;boolean> <a class="idl-code" data-link-type="method" href="#dom-geofence-remove">remove</a>();
};
</pre>
     <p>When getting the <code><dfn class="idl-code" data-dfn-for="Geofence" data-dfn-type="attribute" data-export="" id="dom-geofence-id" title="id">id<a class="self-link" href="#dom-geofence-id"></a></dfn></code> attribute, the <a data-link-type="dfn" href="#user-agent">user
    agent</a> MUST return the <a data-link-type="dfn" href="#geofence-id">geofence ID</a> of the <a data-link-type="dfn" href="#geofence-term">geofence</a>.</p>
     <p>When getting the <code><dfn class="idl-code" data-dfn-for="Geofence" data-dfn-type="attribute" data-export="" id="dom-geofence-region" title="region">region<a class="self-link" href="#dom-geofence-region"></a></dfn></code> attribute, the <a data-link-type="dfn" href="#user-agent">user agent</a> MUST return the <a data-link-type="dfn" href="#geographic-region">geographic region</a> of this <a data-link-type="dfn" href="#geofence-term">geofence</a>.</p>
     <p>The <code><dfn class="idl-code" data-dfn-for="Geofence" data-dfn-type="method" data-export="" id="dom-geofence-remove" title="remove()">remove()<a class="self-link" href="#dom-geofence-remove"></a></dfn></code> method when invoked
    MUST return <a data-link-type="dfn" href="https://www.w3.org/2001/tag/doc/promises-guide#a-new-promise">a new promise</a> <var>promise</var> and run the following steps <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/infrastructure.html#in-parallel">in parallel</a>:</p>
     <ol>
      <li> Let <var>geofence</var> be the <a data-link-type="dfn" href="#geofence-term">geofence</a> represented by this <code class="idl"><a data-link-type="idl" href="#geofence">Geofence</a></code> instance. 
      <li> If <var>geofence</var> is not currently in the <a data-link-type="dfn" href="#list-of-geofences">list of geofences</a> associated with a <a data-link-type="dfn" href="https://slightlyoff.github.io/ServiceWorker/spec/service_worker/index.html#service-worker-registration-concept">service worker registration</a>, <a data-link-type="dfn" href="https://www.w3.org/2001/tag/doc/promises-guide#resolve-promise">resolve</a> <var>promise</var> with <code>false</code> and abort the remainder of these steps. 
      <li> Remove <var>geofence</var> from the <a data-link-type="dfn" href="#list-of-geofences">list of geofences</a> associated
        with the current <a data-link-type="dfn" href="https://slightlyoff.github.io/ServiceWorker/spec/service_worker/index.html#service-worker-registration-concept">service worker registration</a>. No more events related to this
        geofence will be fired after this. 
      <li> Set the <a data-link-type="dfn" href="#state">state</a> of <var>geofence</var> to <a data-link-type="dfn" href="#inactive">inactive</a>, but do not trigger the steps
        that are normally triggered when a <a data-link-type="dfn" href="#geofence-term">geofence</a> is <a data-link-type="dfn" href="#deactivated">deactivated</a>. 
      <li> <a data-link-type="dfn" href="https://www.w3.org/2001/tag/doc/promises-guide#resolve-promise">Resolve</a> <var>promise</var> with <code>true</code>. 
     </ol>
    </section>
    <section>
     <h3 class="heading settled" data-level="4.4" id="geofenceregion-interface"><span class="secno">4.4. </span><span class="content"><code class="idl"><a data-link-type="idl" href="#geofenceregion">GeofenceRegion</a></code> interface</span><a class="self-link" href="#geofenceregion-interface"></a></h3>
<pre class="idl">[Exposed=(Window,Worker)]
interface <dfn class="idl-code" data-dfn-type="interface" data-export="" id="geofenceregion">GeofenceRegion<a class="self-link" href="#geofenceregion"></a></dfn> {
  readonly attribute DOMString <a class="idl-code" data-link-type="attribute" data-readonly="" data-type="DOMString " href="#dom-geofenceregion-name">name</a>;
};

dictionary <dfn class="idl-code" data-dfn-type="dictionary" data-export="" id="dictdef-geofenceregioninit">GeofenceRegionInit<a class="self-link" href="#dictdef-geofenceregioninit"></a></dfn> {
  DOMString? <dfn class="idl-code" data-dfn-for="GeofenceRegionInit" data-dfn-type="dict-member" data-export="" data-type="DOMString? " id="dom-geofenceregioninit-name">name<a class="self-link" href="#dom-geofenceregioninit-name"></a></dfn>;
};
</pre>
     <p>The <code><dfn class="idl-code" data-dfn-for="GeofenceRegion" data-dfn-type="attribute" data-export="" id="dom-geofenceregion-name" title="name">name<a class="self-link" href="#dom-geofenceregion-name"></a></dfn></code> attribute MUST return
    the value it was initialized to. When the object is created, this attribute MUST be set to the
    value of the <code class="idl"><a data-link-type="idl" href="#dom-geofenceregioninit-name">name</a></code> property in the <code class="idl"><a data-link-type="idl" href="#dictdef-geofenceregioninit">GeofenceRegionInit</a></code> dictionary, or
    an empty string if that property wasn’t set.</p>
    </section>
    <section>
     <h3 class="heading settled" data-level="4.5" id="circulargeofenceregion-interface"><span class="secno">4.5. </span><span class="content"><code class="idl"><a data-link-type="idl" href="#circulargeofenceregion">CircularGeofenceRegion</a></code> interface</span><a class="self-link" href="#circulargeofenceregion-interface"></a></h3>
<pre class="idl">[<dfn class="idl-code" data-dfn-for="CircularGeofenceRegion" data-dfn-type="constructor" data-export="" data-lt="CircularGeofenceRegion(init)" id="dom-circulargeofenceregion-circulargeofenceregion">Constructor<a class="self-link" href="#dom-circulargeofenceregion-circulargeofenceregion"></a></dfn>(<a data-link-type="idl-name" href="#dictdef-circulargeofenceregioninit">CircularGeofenceRegionInit</a> <dfn class="idl-code" data-dfn-for="CircularGeofenceRegion/CircularGeofenceRegion(init)" data-dfn-type="argument" data-export="" id="dom-circulargeofenceregion-circulargeofenceregion-init-init">init<a class="self-link" href="#dom-circulargeofenceregion-circulargeofenceregion-init-init"></a></dfn>), Exposed=(Window,Worker)]
interface <dfn class="idl-code" data-dfn-type="interface" data-export="" id="circulargeofenceregion">CircularGeofenceRegion<a class="self-link" href="#circulargeofenceregion"></a></dfn> : <a data-link-type="idl-name" href="#geofenceregion">GeofenceRegion</a> {
  readonly attribute double <a class="idl-code" data-link-type="attribute" data-readonly="" data-type="double " href="#dom-circulargeofenceregion-latitude">latitude</a>;
  readonly attribute double <a class="idl-code" data-link-type="attribute" data-readonly="" data-type="double " href="#dom-circulargeofenceregion-longitude">longitude</a>;
  readonly attribute double <dfn class="idl-code" data-dfn-for="CircularGeofenceRegion" data-dfn-type="attribute" data-export="" data-readonly="" data-type="double " id="dom-circulargeofenceregion-radius">radius<a class="self-link" href="#dom-circulargeofenceregion-radius"></a></dfn>;
};

dictionary <dfn class="idl-code" data-dfn-type="dictionary" data-export="" id="dictdef-circulargeofenceregioninit">CircularGeofenceRegionInit<a class="self-link" href="#dictdef-circulargeofenceregioninit"></a></dfn> {
  double <dfn class="idl-code" data-dfn-for="CircularGeofenceRegionInit" data-dfn-type="dict-member" data-export="" data-type="double " id="dom-circulargeofenceregioninit-latitude">latitude<a class="self-link" href="#dom-circulargeofenceregioninit-latitude"></a></dfn>;
  double <dfn class="idl-code" data-dfn-for="CircularGeofenceRegionInit" data-dfn-type="dict-member" data-export="" data-type="double " id="dom-circulargeofenceregioninit-longitude">longitude<a class="self-link" href="#dom-circulargeofenceregioninit-longitude"></a></dfn>;
  double <dfn class="idl-code" data-dfn-for="CircularGeofenceRegionInit" data-dfn-type="dict-member" data-export="" data-type="double " id="dom-circulargeofenceregioninit-radius">radius<a class="self-link" href="#dom-circulargeofenceregioninit-radius"></a></dfn>;
};
</pre>
     <p>The <code class="idl"><a data-link-type="idl" href="#circulargeofenceregion">CircularGeofenceRegion</a></code> constructor when invoked MUST initialize the properties of the
    newly created object to the corresponding attributes in the initializer.</p>
     <p>The <code><dfn class="idl-code" data-dfn-for="CircularGeofenceRegion" data-dfn-type="attribute" data-export="" id="dom-circulargeofenceregion-latitude" title="latitude">latitude<a class="self-link" href="#dom-circulargeofenceregion-latitude"></a></dfn></code> attribute
    MUST return the value it was intialized to. This value represents the latitude in
    circular degrees of the center of the circular region.</p>
     <p>The <code><dfn class="idl-code" data-dfn-for="CircularGeofenceRegion" data-dfn-type="attribute" data-export="" id="dom-circulargeofenceregion-longitude" title="longitude">longitude<a class="self-link" href="#dom-circulargeofenceregion-longitude"></a></dfn></code> attribute MUST return the value it was intialized to. This value represents the longitude
    in circular degrees of the center of the circular region.</p>
    </section>
    <section>
     <h3 class="heading settled" data-level="4.6" id="events"><span class="secno">4.6. </span><span class="content">Events</span><a class="self-link" href="#events"></a></h3>
     <p>The Service Worker specification defines a <code class="idl"><a data-link-type="idl" href="https://slightlyoff.github.io/ServiceWorker/spec/service_worker/index.html#service-worker-global-scope-interface">ServiceWorkerGlobalScope</a></code> interface, which this
    specification extends.</p>
<pre class="idl">partial interface <a class="idl-code" data-link-type="interface" href="https://slightlyoff.github.io/ServiceWorker/spec/service_worker/index.html#service-worker-global-scope-interface">ServiceWorkerGlobalScope</a> {
  attribute <a data-link-type="idl-name" href="https://html.spec.whatwg.org/multipage/webappapis.html#eventhandler">EventHandler</a> <a class="idl-code" data-link-type="attribute" data-type="EventHandler " href="#dom-serviceworkerglobalscope-ongeofenceenter">ongeofenceenter</a>;
  attribute <a data-link-type="idl-name" href="https://html.spec.whatwg.org/multipage/webappapis.html#eventhandler">EventHandler</a> <a class="idl-code" data-link-type="attribute" data-type="EventHandler " href="#dom-serviceworkerglobalscope-ongeofenceleave">ongeofenceleave</a>;
  attribute <a data-link-type="idl-name" href="https://html.spec.whatwg.org/multipage/webappapis.html#eventhandler">EventHandler</a> <a class="idl-code" data-link-type="attribute" data-type="EventHandler " href="#dom-serviceworkerglobalscope-ongeofenceerror">ongeofenceerror</a>;
};
</pre>
     <p>The <code><dfn class="idl-code" data-dfn-for="ServiceWorkerGlobalScope" data-dfn-type="attribute" data-export="" id="dom-serviceworkerglobalscope-ongeofenceenter" title="ongeofenceenter">ongeofenceenter<a class="self-link" href="#dom-serviceworkerglobalscope-ongeofenceenter"></a></dfn></code> attribute is
    an <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/webappapis.html#event-handlers">event handler</a> whose corresponding <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/webappapis.html#event-handler-event-type">event handler event type</a> is <code><dfn data-dfn-type="dfn" data-noexport="" id="geofenceenter">geofenceenter<a class="self-link" href="#geofenceenter"></a></dfn></code>.</p>
     <p>The <code><dfn class="idl-code" data-dfn-for="ServiceWorkerGlobalScope" data-dfn-type="attribute" data-export="" id="dom-serviceworkerglobalscope-ongeofenceleave" title="ongeofenceleave">ongeofenceleave<a class="self-link" href="#dom-serviceworkerglobalscope-ongeofenceleave"></a></dfn></code> attribute is
    an <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/webappapis.html#event-handlers">event handler</a> whose corresponding <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/webappapis.html#event-handler-event-type">event handler event type</a> is <code><dfn data-dfn-type="dfn" data-noexport="" id="geofenceleave">geofenceleave<a class="self-link" href="#geofenceleave"></a></dfn></code>.</p>
     <p>The <code><dfn class="idl-code" data-dfn-for="ServiceWorkerGlobalScope" data-dfn-type="attribute" data-export="" id="dom-serviceworkerglobalscope-ongeofenceerror" title="ongeofenceerror">ongeofenceerror<a class="self-link" href="#dom-serviceworkerglobalscope-ongeofenceerror"></a></dfn></code> attribute is
    an <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/webappapis.html#event-handlers">event handler</a> whose corresponding <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/webappapis.html#event-handler-event-type">event handler event type</a> is <code><dfn data-dfn-type="dfn" data-noexport="" id="geofenceerror">geofenceerror<a class="self-link" href="#geofenceerror"></a></dfn></code>.</p>
     <section>
      <h4 class="heading settled" data-level="4.6.1" id="the-geofenceenter-and-geofenceleave-events"><span class="secno">4.6.1. </span><span class="content"> The <code>geofenceenter</code> and <code>geofenceleave</code> events </span><a class="self-link" href="#the-geofenceenter-and-geofenceleave-events"></a></h4>
      <p>The <code class="idl"><a data-link-type="idl" href="#geofenceevent">GeofenceEvent</a></code> interface represents a geofence being <a data-link-type="dfn" href="#breached">breached</a>.</p>
<pre class="idl">[Exposed=ServiceWorker]
interface <dfn class="idl-code" data-dfn-type="interface" data-export="" id="geofenceevent">GeofenceEvent<a class="self-link" href="#geofenceevent"></a></dfn> : <a data-link-type="idl-name" href="https://slightlyoff.github.io/ServiceWorker/spec/service_worker/index.html#extendable-event-interface">ExtendableEvent</a> {
  readonly attribute <a data-link-type="idl-name" href="#geofence">Geofence</a> <dfn class="idl-code" data-dfn-for="GeofenceEvent" data-dfn-type="attribute" data-export="" data-readonly="" data-type="Geofence " id="dom-geofenceevent-geofence">geofence<a class="self-link" href="#dom-geofenceevent-geofence"></a></dfn>;
  readonly attribute <a data-link-type="idl-name" href="http://www.w3.org/TR/geolocation-API/#position_interface">Position</a>? <dfn class="idl-code" data-dfn-for="GeofenceEvent" data-dfn-type="attribute" data-export="" data-readonly="" data-type="Position? " id="dom-geofenceevent-position">position<a class="self-link" href="#dom-geofenceevent-position"></a></dfn>;
};
</pre>
      <p>Upon detecting a <a data-link-type="dfn" href="#breached" title="breached">breach</a> of a <a data-link-type="dfn" href="#geofence-term">geofence</a> <var>geofence</var>,
      the <a data-link-type="dfn" href="#user-agent">user agent</a> MUST run the following steps to <dfn data-dfn-type="dfn" data-noexport="" id="fire-a-geofence-event">fire a geofence event<a class="self-link" href="#fire-a-geofence-event"></a></dfn>:</p>
      <ol>
       <li> Let <var>serviceWorkerRegistration</var> be the <a data-link-type="dfn" href="https://slightlyoff.github.io/ServiceWorker/spec/service_worker/index.html#service-worker-registration-concept">service worker registration</a> <var>geofence</var> is associated with. 
       <li>
         Invoke the <a data-link-type="dfn" href="https://slightlyoff.github.io/ServiceWorker/spec/service_worker/index.html#handle-functional-event-algorithm">Handle Functional Event</a> algorithm with <var>serviceWorkerRegistration</var> and the algorithm represented by the following substeps as arguments. 
        <ol>
         <li> Let <var>globalObject</var> be the <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/webappapis.html#global-object">global object</a> these steps are invoked with. 
         <li> Let <var>eventType</var> be <code><a data-link-type="dfn" href="#geofenceenter">geofenceenter</a></code> or <code><a data-link-type="dfn" href="#geofenceleave">geofenceleave</a></code>, corresponding to the type of <a data-link-type="dfn" href="#breached" title="breached">breach</a> event being processed. 
         <li> Create a <a data-link-type="dfn" href="https://html.spec.whatwg.org/#concept-events-trusted">trusted</a> event <var>event</var> that uses the <code class="idl"><a data-link-type="idl" href="#geofenceevent">GeofenceEvent</a></code> interface, with event type equal to <var>eventType</var>. 
         <li> Let the <code class="idl"><a data-link-type="idl" href="#dom-geofenceevent-geofence">geofence</a></code> atrribute of <var>event</var> be initialized to
              a new <code class="idl"><a data-link-type="idl" href="#geofence">Geofence</a></code> instance representing <var>geofence</var>. 
         <li> If the <a data-link-type="dfn" href="#include-position">include position</a> flag of <var>geofence</var> is true, set the <code class="idl"><a data-link-type="idl" href="#dom-geofenceevent-position">position</a></code> attribute of <var>event</var> to the current geographical
              position. 
         <li> Dispatch <var>event</var> at <var>globalObject</var>. 
        </ol>
      </ol>
      <p>The <a data-link-type="dfn" href="#user-agent">user agent</a> MAY wait with <a data-link-type="dfn" href="#fire-a-geofence-event">firing a geofence
      event</a> until some time and/or distance has passed after the <a data-link-type="dfn" href="#breached" title="breached">breach</a> was detected before firing an event to make sure that the
      geofence really was <a data-link-type="dfn" href="#breached">breached</a>.</p>
     </section>
     <section>
      <h4 class="heading settled" data-level="4.6.2" id="geofenceerrorevent-section"><span class="secno">4.6.2. </span><span class="content"><code class="idl"><a data-link-type="idl" href="#geofenceerrorevent">GeofenceErrorEvent</a></code></span><a class="self-link" href="#geofenceerrorevent-section"></a></h4>
<pre class="idl">[Exposed=ServiceWorker]
interface <dfn class="idl-code" data-dfn-type="interface" data-export="" id="geofenceerrorevent">GeofenceErrorEvent<a class="self-link" href="#geofenceerrorevent"></a></dfn> : <a data-link-type="idl-name" href="https://slightlyoff.github.io/ServiceWorker/spec/service_worker/index.html#extendable-event-interface">ExtendableEvent</a> {
  readonly attribute <a data-link-type="idl-name" href="#geofence">Geofence</a> <dfn class="idl-code" data-dfn-for="GeofenceErrorEvent" data-dfn-type="attribute" data-export="" data-readonly="" data-type="Geofence " id="dom-geofenceerrorevent-geofence">geofence<a class="self-link" href="#dom-geofenceerrorevent-geofence"></a></dfn>;
  readonly attribute DOMString <dfn class="idl-code" data-dfn-for="GeofenceErrorEvent" data-dfn-type="attribute" data-export="" data-readonly="" data-type="DOMString " id="dom-geofenceerrorevent-error">error<a class="self-link" href="#dom-geofenceerrorevent-error"></a></dfn>;
  readonly attribute DOMString <dfn class="idl-code" data-dfn-for="GeofenceErrorEvent" data-dfn-type="attribute" data-export="" data-readonly="" data-type="DOMString " id="dom-geofenceerrorevent-message">message<a class="self-link" href="#dom-geofenceerrorevent-message"></a></dfn>;
};
</pre>
      <p>When a <a data-link-type="dfn" href="#geofence-term">geofence</a> <var>geofence</var> is <dfn data-dfn-type="dfn" data-noexport="" id="deactivated">deactivated<a class="self-link" href="#deactivated"></a></dfn>, the <a data-link-type="dfn" href="#user-agent">user agent</a> SHOULD run the following steps:</p>
      <ol>
       <li> Let <var>serviceWorkerRegistration</var> be the <a data-link-type="dfn" href="https://slightlyoff.github.io/ServiceWorker/spec/service_worker/index.html#service-worker-registration-concept">service worker registration</a> <var>geofence</var> is associated with. 
       <li> Let <var>oldState</var> be the <a data-link-type="dfn" href="#state">state</a> of <var>geofence</var>. 
       <li> Set the <a data-link-type="dfn" href="#state">state</a> of <var>geofence</var> to <a data-link-type="dfn" href="#inactive">inactive</a>. 
       <li>
         If <var>oldState</var> is <a data-link-type="dfn" href="#active">active</a>, invoke the <a data-link-type="dfn" href="https://slightlyoff.github.io/ServiceWorker/spec/service_worker/index.html#handle-functional-event-algorithm">Handle Functional Event</a> algorithm with <var>serviceWorkerRegistration</var> and the algorithm represented by
          the following substeps as arguments. 
        <ol>
         <li> Let <var>globalObject</var> be the <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/webappapis.html#global-object">global object</a> these steps are invoked with. 
         <li> Create a <a data-link-type="dfn" href="https://html.spec.whatwg.org/#concept-events-trusted">trusted</a> event <var>event</var> that uses the <code class="idl"><a data-link-type="idl" href="#geofenceerrorevent">GeofenceErrorEvent</a></code> interface, with event type <code><a data-link-type="dfn" href="#geofenceerror">geofenceerror</a></code>. 
         <li> Let the <code class="idl"><a data-link-type="idl" href="#dom-geofenceerrorevent-geofence">geofence</a></code> atrribute of <var>event</var> be initialized to
              a new <code class="idl"><a data-link-type="idl" href="#geofence">Geofence</a></code> instance representing <var>geofence</var>. 
         <li> Let the <code class="idl"><a data-link-type="idl" href="#dom-geofenceerrorevent-error">error</a></code> attribute of <var>event</var> be initialized to
              an error name. 
         <li> Let the <code class="idl"><a data-link-type="idl" href="#dom-geofenceerrorevent-message">message</a></code> attribute of <var>event</var> be initialized to
              a descriptive message for the error that occurred. 
         <li> Dispatch <var>event</var> at <var>globalObject</var>. 
        </ol>
      </ol>
     </section>
    </section>
   </section>
   <section>
    <h2 class="heading settled" data-level="5" id="exceptions"><span class="secno">5. </span><span class="content">Exceptions</span><a class="self-link" href="#exceptions"></a></h2>
    <p>The Geofencing API uses the new <code><dfn class="idl-code" data-dfn-type="exception" data-export="" id="exceptdef-permissiondeniederror">PermissionDeniedError<a class="self-link" href="#exceptdef-permissiondeniederror"></a></dfn></code> <code class="idl"><a data-link-type="idl" href="https://heycam.github.io/webidl/#idl-DOMException-error-names">DOMException</a></code> name.</p>
   </section>
  </main>
  <h2 class="no-ref no-num heading settled" id="conformance"><span class="content">Conformance</span><a class="self-link" href="#conformance"></a></h2>
  <h3 class="no-ref no-num heading settled" id="conventions"><span class="content">Document conventions</span><a class="self-link" href="#conventions"></a></h3>
  <p>This specification defines conformance criteria that apply to a single product: the <dfn data-dfn-type="dfn" data-noexport="" id="user-agent">user agent<a class="self-link" href="#user-agent"></a></dfn> that implements the interfaces that it contains. </p>
  <p>Conformance requirements are expressed with a combination of
    descriptive assertions and RFC 2119 terminology. The key words "MUST",
    "MUST NOT", "REQUIRED", "SHALL", "SHALL NOT", "SHOULD", "SHOULD NOT",
    "RECOMMENDED", "MAY", and "OPTIONAL" in the normative parts of this
    document are to be interpreted as described in RFC 2119.
    However, for readability, these words do not appear in all uppercase
    letters in this specification. </p>
  <p>All of the text of this specification is normative except sections
    explicitly marked as non-normative, examples, and notes. <a data-link-type="biblio" href="#biblio-rfc2119">[RFC2119]</a></p>
  <p>Examples in this specification are introduced with the words "for example"
    or are set apart from the normative text with <code>class="example"</code>,
    like this: </p>
  <div class="example" id="example-f839f6c8">
   <a class="self-link" href="#example-f839f6c8"></a> 
   <p>This is an example of an informative example.</p>
  </div>
  <p>Informative notes begin with the word "Note" and are set apart from the
    normative text with <code>class="note"</code>, like this: </p>
  <p class="note" role="note">Note, this is an informative note.</p>
  <h3 class="no-ref no-num heading settled" id="conformant-algorithms"><span class="content">Conformant Algorithms</span><a class="self-link" href="#conformant-algorithms"></a></h3>
  <p>Requirements phrased in the imperative as part of algorithms (such as
    "strip any leading space characters" or "return false and abort these
    steps") are to be interpreted with the meaning of the key word ("must",
    "should", "may", etc) used in introducing the algorithm.</p>
  <p>Conformance requirements phrased as algorithms or specific steps can be
    implemented in any manner, so long as the end result is equivalent. In
    particular, the algorithms defined in this specification are intended to
    be easy to understand and are not intended to be performant. Implementers
    are encouraged to optimize.</p>
  <h2 class="no-num heading settled" id="index"><span class="content">Index</span><a class="self-link" href="#index"></a></h2>
  <h3 class="no-num heading settled" id="index-defined-here"><span class="content">Terms defined by this specification</span><a class="self-link" href="#index-defined-here"></a></h3>
  <ul class="indexlist">
   <li><a href="#active">active</a><span>, in §2</span>
   <li><a href="#dom-geofencemanager-add">add(initialRegion)</a><span>, in §4.2</span>
   <li><a href="#dom-geofencemanager-add">add(initialRegion, options)</a><span>, in §4.2</span>
   <li><a href="#breached">breached</a><span>, in §2</span>
   <li><a href="#circulargeofenceregion">CircularGeofenceRegion</a><span>, in §4.5</span>
   <li><a href="#dom-circulargeofenceregion-circulargeofenceregion">CircularGeofenceRegion(init)</a><span>, in §4.5</span>
   <li><a href="#dictdef-circulargeofenceregioninit">CircularGeofenceRegionInit</a><span>, in §4.5</span>
   <li><a href="#deactivated">deactivated</a><span>, in §4.6.2</span>
   <li><a href="#enter-event">enter event</a><span>, in §2</span>
   <li><a href="#dom-geofenceerrorevent-error">error</a><span>, in §4.6.2</span>
   <li><a href="#fire-a-geofence-event">fire a geofence event</a><span>, in §4.6.1</span>
   <li>
    geofence
    <ul>
     <li><a href="#geofence-term">definition of</a><span>, in §2</span>
     <li><a href="#dom-geofenceevent-geofence">attribute for GeofenceEvent</a><span>, in §4.6.1</span>
     <li><a href="#dom-geofenceerrorevent-geofence">attribute for GeofenceErrorEvent</a><span>, in §4.6.2</span>
    </ul>
   <li><a href="#geofence">Geofence</a><span>, in §4.3</span>
   <li><a href="#geofenceenter">geofenceenter</a><span>, in §4.6</span>
   <li><a href="#geofenceerror">geofenceerror</a><span>, in §4.6</span>
   <li><a href="#geofenceerrorevent">GeofenceErrorEvent</a><span>, in §4.6.2</span>
   <li><a href="#geofenceevent">GeofenceEvent</a><span>, in §4.6.1</span>
   <li><a href="#geofence-id">geofence ID</a><span>, in §2</span>
   <li><a href="#geofenceleave">geofenceleave</a><span>, in §4.6</span>
   <li><a href="#geofence-limit">geofence limit</a><span>, in §2.1</span>
   <li><a href="#geofencemanager">GeofenceManager</a><span>, in §4.2</span>
   <li><a href="#geofence-name">geofence name</a><span>, in §2</span>
   <li><a href="#dictdef-geofenceoptions">GeofenceOptions</a><span>, in §4.2</span>
   <li><a href="#dictdef-geofencequeryoptions">GeofenceQueryOptions</a><span>, in §4.2</span>
   <li><a href="#geofenceregion">GeofenceRegion</a><span>, in §4.4</span>
   <li><a href="#dictdef-geofenceregioninit">GeofenceRegionInit</a><span>, in §4.4</span>
   <li><a href="#dom-serviceworkerregistration-geofencing">geofencing</a><span>, in §4.1</span>
   <li><a href="#geographic-coordinate">geographic coordinate</a><span>, in §2</span>
   <li><a href="#geographic-region">geographic region</a><span>, in §2</span>
   <li><a href="#dom-geofencemanager-getall">getAll()</a><span>, in §4.2</span>
   <li><a href="#dom-geofencemanager-getall">getAll(options)</a><span>, in §4.2</span>
   <li><a href="#dom-geofencemanager-getbyid">getById(id)</a><span>, in §4.2</span>
   <li>
    id
    <ul>
     <li><a href="#dom-geofencemanager-getbyid-id-id">argument for GeofenceManager/getById(id)</a><span>, in §4.2</span>
     <li><a href="#dom-geofence-id">attribute for Geofence</a><span>, in §4.3</span>
    </ul>
   <li><a href="#inactive">inactive</a><span>, in §2</span>
   <li><a href="#dom-geofenceoptions-includeposition">includePosition</a><span>, in §4.2</span>
   <li><a href="#include-position">include position</a><span>, in §2</span>
   <li><a href="#dom-circulargeofenceregion-circulargeofenceregion-init-init">init</a><span>, in §4.5</span>
   <li><a href="#dom-geofencemanager-add-initialregion-options-initialregion">initialRegion</a><span>, in §4.2</span>
   <li>
    latitude
    <ul>
     <li><a href="#dom-circulargeofenceregioninit-latitude">dict-member for CircularGeofenceRegionInit</a><span>, in §4.5</span>
     <li><a href="#dom-circulargeofenceregion-latitude">attribute for CircularGeofenceRegion</a><span>, in §4.5</span>
    </ul>
   <li><a href="#leave-event">leave
  event</a><span>, in §2</span>
   <li><a href="#list-of-geofences">list of geofences</a><span>, in §2</span>
   <li>
    longitude
    <ul>
     <li><a href="#dom-circulargeofenceregioninit-longitude">dict-member for CircularGeofenceRegionInit</a><span>, in §4.5</span>
     <li><a href="#dom-circulargeofenceregion-longitude">attribute for CircularGeofenceRegion</a><span>, in §4.5</span>
    </ul>
   <li><a href="#dom-geofenceerrorevent-message">message</a><span>, in §4.6.2</span>
   <li>
    name
    <ul>
     <li><a href="#dom-geofencequeryoptions-name">dict-member for GeofenceQueryOptions</a><span>, in §4.2</span>
     <li><a href="#dom-geofenceregioninit-name">dict-member for GeofenceRegionInit</a><span>, in §4.4</span>
     <li><a href="#dom-geofenceregion-name">attribute for GeofenceRegion</a><span>, in §4.4</span>
    </ul>
   <li><a href="#name-limit">name limit</a><span>, in §2.1</span>
   <li><a href="#dom-serviceworkerglobalscope-ongeofenceenter">ongeofenceenter</a><span>, in §4.6</span>
   <li><a href="#dom-serviceworkerglobalscope-ongeofenceerror">ongeofenceerror</a><span>, in §4.6</span>
   <li><a href="#dom-serviceworkerglobalscope-ongeofenceleave">ongeofenceleave</a><span>, in §4.6</span>
   <li>
    options
    <ul>
     <li><a href="#dom-geofencemanager-add-initialregion-options-options">argument for GeofenceManager/add(initialRegion, options), GeofenceManager/add(initialRegion)</a><span>, in §4.2</span>
     <li><a href="#dom-geofencemanager-getall-options-options">argument for GeofenceManager/getAll(options), GeofenceManager/getAll()</a><span>, in §4.2</span>
    </ul>
   <li><a href="#exceptdef-permissiondeniederror">PermissionDeniedError</a><span>, in §5</span>
   <li><a href="#dom-geofenceevent-position">position</a><span>, in §4.6.1</span>
   <li>
    radius
    <ul>
     <li><a href="#radius">definition of</a><span>, in §2</span>
     <li><a href="#dom-circulargeofenceregion-radius">attribute for CircularGeofenceRegion</a><span>, in §4.5</span>
     <li><a href="#dom-circulargeofenceregioninit-radius">dict-member for CircularGeofenceRegionInit</a><span>, in §4.5</span>
    </ul>
   <li><a href="#dom-geofence-region">region</a><span>, in §4.3</span>
   <li><a href="#dom-geofence-remove">remove()</a><span>, in §4.3</span>
   <li><a href="#state">state</a><span>, in §2</span>
   <li><a href="#user-agent">user agent</a><span>, in §Unnumbered section</span>
   <li><a href="#webapp">webapp</a><span>, in §2</span>
  </ul>
  <h3 class="no-num heading settled" id="index-defined-elsewhere"><span class="content">Terms defined by reference</span><a class="self-link" href="#index-defined-elsewhere"></a></h3>
  <ul class="indexlist">
   <li>
    <a data-link-type="biblio" href="#biblio-webidl">[WebIDL]</a> defines the following terms:
    <ul>
     <li><a href="https://heycam.github.io/webidl/#idl-DOMException-error-names">DOMException</a>
     <li><a href="https://heycam.github.io/webidl/#quotaexceedederror">QuotaExceededError</a>
     <li><a href="https://heycam.github.io/webidl/#idl-sequence">sequence</a>
    </ul>
   <li>
    <a data-link-type="biblio" href="#biblio-ecma-262">[ECMA-262]</a> defines the following terms:
    <ul>
     <li><a href="http://www.ecma-international.org/ecma-262/6.0/#sec-native-error-types-used-in-this-standard-rangeerror">RangeError</a>
     <li><a href="http://www.ecma-international.org/ecma-262/6.0/#sec-native-error-types-used-in-this-standard-typeerror">TypeError</a>
    </ul>
   <li>
    <a data-link-type="biblio" href="#biblio-geolocation-api">[geolocation-API]</a> defines the following terms:
    <ul>
     <li><a href="http://www.w3.org/TR/geolocation-API/#position_interface">Position</a>
    </ul>
   <li>
    <a data-link-type="biblio" href="#biblio-html">[HTML]</a> defines the following terms:
    <ul>
     <li><a href="https://html.spec.whatwg.org/multipage/webappapis.html#eventhandler">EventHandler</a>
     <li><a href="https://html.spec.whatwg.org/multipage/webappapis.html#event-handler-event-type">event handler event type</a>
     <li><a href="https://html.spec.whatwg.org/multipage/webappapis.html#event-handlers">event handlers</a>
     <li><a href="https://html.spec.whatwg.org/multipage/webappapis.html#global-object">global object</a>
     <li><a href="https://html.spec.whatwg.org/multipage/infrastructure.html#in-parallel">in parallel</a>
     <li><a href="https://html.spec.whatwg.org/#concept-events-trusted">trusted</a>
    </ul>
   <li>
    <a data-link-type="biblio" href="#biblio-powerful-features">[powerful-features]</a> defines the following terms:
    <ul>
     <li><a href="https://w3c.github.io/webappsec/specs/powerfulfeatures/#secure-context">secure context</a>
    </ul>
   <li>
    <a data-link-type="biblio" href="#biblio-promises-guide">[promises-guide]</a> defines the following terms:
    <ul>
     <li><a href="https://www.w3.org/2001/tag/doc/promises-guide#a-new-promise">a new promise</a>
     <li><a href="https://www.w3.org/2001/tag/doc/promises-guide#reject-promise">reject</a>
     <li><a href="https://www.w3.org/2001/tag/doc/promises-guide#resolve-promise">resolve</a>
    </ul>
   <li>
    <a data-link-type="biblio" href="#biblio-service-workers">[service-workers]</a> defines the following terms:
    <ul>
     <li><a href="https://slightlyoff.github.io/ServiceWorker/spec/service_worker/index.html#extendable-event-interface">ExtendableEvent</a>
     <li><a href="https://slightlyoff.github.io/ServiceWorker/spec/service_worker/index.html#service-worker-global-scope-interface">ServiceWorkerGlobalScope</a>
     <li><a href="https://slightlyoff.github.io/ServiceWorker/spec/service_worker/index.html#service-worker-registration-interface">ServiceWorkerRegistration</a>
     <li><a href="https://slightlyoff.github.io/ServiceWorker/spec/service_worker/index.html#handle-functional-event-algorithm">handle functional event</a>
     <li><a href="https://slightlyoff.github.io/ServiceWorker/spec/service_worker/index.html#service-worker-registration-concept">service worker registration</a>
    </ul>
  </ul>
  <h2 class="no-num heading settled" id="references"><span class="content">References</span><a class="self-link" href="#references"></a></h2>
  <h3 class="no-num heading settled" id="normative"><span class="content">Normative References</span><a class="self-link" href="#normative"></a></h3>
  <dl>
   <dt id="biblio-ecma-262"><a class="self-link" href="#biblio-ecma-262"></a>[ECMA-262]
   <dd>Allen Wirfs-Brock. <a href="http://www.ecma-international.org/ecma-262/6.0/">ECMA-262 6th Edition, The ECMAScript 2015 Language Specification</a>. June 2015. Standard. URL: <a href="http://www.ecma-international.org/ecma-262/6.0/">http://www.ecma-international.org/ecma-262/6.0/</a>
   <dt id="biblio-html"><a class="self-link" href="#biblio-html"></a>[HTML]
   <dd>Ian Hickson. <a href="https://html.spec.whatwg.org/multipage/">HTML Standard</a>. Living Standard. URL: <a href="https://html.spec.whatwg.org/multipage/">https://html.spec.whatwg.org/multipage/</a>
   <dt id="biblio-wgs84"><a class="self-link" href="#biblio-wgs84"></a>[WGS84]
   <dd><a href="http://earth-info.nga.mil/GandG/publications/tr8350.2/wgs84fin.pdf">National Imagery and Mapping Agency Technical Report 8350.2, Third Edition</a>. 3 January 2000. URL: <a href="http://earth-info.nga.mil/GandG/publications/tr8350.2/wgs84fin.pdf">http://earth-info.nga.mil/GandG/publications/tr8350.2/wgs84fin.pdf</a>
   <dt id="biblio-webidl"><a class="self-link" href="#biblio-webidl"></a>[WebIDL]
   <dd>Cameron McCormack; Boris Zbarsky. <a href="http://www.w3.org/TR/WebIDL-1/">WebIDL Level 1</a>. 4 August 2015. WD. URL: <a href="http://www.w3.org/TR/WebIDL-1/">http://www.w3.org/TR/WebIDL-1/</a>
   <dt id="biblio-geolocation-api"><a class="self-link" href="#biblio-geolocation-api"></a>[geolocation-API]
   <dd>Andrei Popescu. <a href="http://www.w3.org/TR/geolocation-API/">Geolocation API Specification</a>. 28 May 2015. PER. URL: <a href="http://www.w3.org/TR/geolocation-API/">http://www.w3.org/TR/geolocation-API/</a>
   <dt id="biblio-powerful-features"><a class="self-link" href="#biblio-powerful-features"></a>[POWERFUL-FEATURES]
   <dd>Mike West; Yan Zhu. <a href="http://www.w3.org/TR/powerful-features/">Privileged Contexts</a>. 24 April 2015. WD. URL: <a href="http://www.w3.org/TR/powerful-features/">http://www.w3.org/TR/powerful-features/</a>
   <dt id="biblio-promises-guide"><a class="self-link" href="#biblio-promises-guide"></a>[PROMISES-GUIDE]
   <dd><a href="https://www.w3.org/2001/tag/doc/promises-guide">Writing Promise-Using Specifications</a>. 24 July 2015. Finding of the W3C TAG. URL: <a href="https://www.w3.org/2001/tag/doc/promises-guide">https://www.w3.org/2001/tag/doc/promises-guide</a>
   <dt id="biblio-rfc2119"><a class="self-link" href="#biblio-rfc2119"></a>[RFC2119]
   <dd>S. Bradner. <a href="https://tools.ietf.org/html/rfc2119">Key words for use in RFCs to Indicate Requirement Levels</a>. March 1997. Best Current Practice. URL: <a href="https://tools.ietf.org/html/rfc2119">https://tools.ietf.org/html/rfc2119</a>
   <dt id="biblio-service-workers"><a class="self-link" href="#biblio-service-workers"></a>[SERVICE-WORKERS]
   <dd>Alex Russell; Jungkee Song; Jake Archibald. <a href="http://www.w3.org/TR/service-workers/">Service Workers</a>. 25 June 2015. WD. URL: <a href="http://www.w3.org/TR/service-workers/">http://www.w3.org/TR/service-workers/</a>
  </dl>
  <h2 class="no-num heading settled" id="idl-index"><span class="content">IDL Index</span><a class="self-link" href="#idl-index"></a></h2>
<pre class="idl">partial interface <a class="idl-code" data-link-type="interface" href="https://slightlyoff.github.io/ServiceWorker/spec/service_worker/index.html#service-worker-registration-interface">ServiceWorkerRegistration</a> {
  readonly attribute <a data-link-type="idl-name" href="#geofencemanager">GeofenceManager</a> <a data-readonly="" data-type="GeofenceManager " href="#dom-serviceworkerregistration-geofencing">geofencing</a>;
};

[NoInterfaceObject]
interface <a href="#geofencemanager">GeofenceManager</a> {
  Promise&lt;<a data-link-type="idl-name" href="#geofence">Geofence</a>> <a class="idl-code" data-link-type="method" href="#dom-geofencemanager-add">add</a>(<a data-link-type="idl-name" href="#geofenceregion">GeofenceRegion</a> <a href="#dom-geofencemanager-add-initialregion-options-initialregion">initialRegion</a>, optional <a data-link-type="idl-name" href="#dictdef-geofenceoptions">GeofenceOptions</a> <a href="#dom-geofencemanager-add-initialregion-options-options">options</a>);
  Promise&lt;sequence&lt;<a data-link-type="idl-name" href="#geofence">Geofence</a>>> <a class="idl-code" data-link-type="method" href="#dom-geofencemanager-getall">getAll</a>(optional <a data-link-type="idl-name" href="#dictdef-geofencequeryoptions">GeofenceQueryOptions</a> <a href="#dom-geofencemanager-getall-options-options">options</a>);
  Promise&lt;<a data-link-type="idl-name" href="#geofence">Geofence</a>> <a class="idl-code" data-link-type="method" href="#dom-geofencemanager-getbyid">getById</a>(DOMString <a href="#dom-geofencemanager-getbyid-id-id">id</a>);
};

dictionary <a href="#dictdef-geofenceoptions">GeofenceOptions</a> {
  boolean <a class="idl-code" data-default="false" data-link-type="dict-member" data-type="boolean " href="#dom-geofenceoptions-includeposition">includePosition</a> = false;
};

dictionary <a href="#dictdef-geofencequeryoptions">GeofenceQueryOptions</a> {
  DOMString? <a data-type="DOMString? " href="#dom-geofencequeryoptions-name">name</a>;
};

[Exposed=(Window,Worker)]
interface <a href="#geofence">Geofence</a> {
  readonly attribute DOMString <a class="idl-code" data-link-type="attribute" data-readonly="" data-type="DOMString " href="#dom-geofence-id">id</a>;
  readonly attribute <a data-link-type="idl-name" href="#geofenceregion">GeofenceRegion</a> <a class="idl-code" data-link-type="attribute" data-readonly="" data-type="GeofenceRegion " href="#dom-geofence-region">region</a>;
  Promise&lt;boolean> <a class="idl-code" data-link-type="method" href="#dom-geofence-remove">remove</a>();
};

[Exposed=(Window,Worker)]
interface <a href="#geofenceregion">GeofenceRegion</a> {
  readonly attribute DOMString <a class="idl-code" data-link-type="attribute" data-readonly="" data-type="DOMString " href="#dom-geofenceregion-name">name</a>;
};

dictionary <a href="#dictdef-geofenceregioninit">GeofenceRegionInit</a> {
  DOMString? <a data-type="DOMString? " href="#dom-geofenceregioninit-name">name</a>;
};

[<a href="#dom-circulargeofenceregion-circulargeofenceregion">Constructor</a>(<a data-link-type="idl-name" href="#dictdef-circulargeofenceregioninit">CircularGeofenceRegionInit</a> <a href="#dom-circulargeofenceregion-circulargeofenceregion-init-init">init</a>), Exposed=(Window,Worker)]
interface <a href="#circulargeofenceregion">CircularGeofenceRegion</a> : <a data-link-type="idl-name" href="#geofenceregion">GeofenceRegion</a> {
  readonly attribute double <a class="idl-code" data-link-type="attribute" data-readonly="" data-type="double " href="#dom-circulargeofenceregion-latitude">latitude</a>;
  readonly attribute double <a class="idl-code" data-link-type="attribute" data-readonly="" data-type="double " href="#dom-circulargeofenceregion-longitude">longitude</a>;
  readonly attribute double <a data-readonly="" data-type="double " href="#dom-circulargeofenceregion-radius">radius</a>;
};

dictionary <a href="#dictdef-circulargeofenceregioninit">CircularGeofenceRegionInit</a> {
  double <a data-type="double " href="#dom-circulargeofenceregioninit-latitude">latitude</a>;
  double <a data-type="double " href="#dom-circulargeofenceregioninit-longitude">longitude</a>;
  double <a data-type="double " href="#dom-circulargeofenceregioninit-radius">radius</a>;
};

partial interface <a class="idl-code" data-link-type="interface" href="https://slightlyoff.github.io/ServiceWorker/spec/service_worker/index.html#service-worker-global-scope-interface">ServiceWorkerGlobalScope</a> {
  attribute <a data-link-type="idl-name" href="https://html.spec.whatwg.org/multipage/webappapis.html#eventhandler">EventHandler</a> <a class="idl-code" data-link-type="attribute" data-type="EventHandler " href="#dom-serviceworkerglobalscope-ongeofenceenter">ongeofenceenter</a>;
  attribute <a data-link-type="idl-name" href="https://html.spec.whatwg.org/multipage/webappapis.html#eventhandler">EventHandler</a> <a class="idl-code" data-link-type="attribute" data-type="EventHandler " href="#dom-serviceworkerglobalscope-ongeofenceleave">ongeofenceleave</a>;
  attribute <a data-link-type="idl-name" href="https://html.spec.whatwg.org/multipage/webappapis.html#eventhandler">EventHandler</a> <a class="idl-code" data-link-type="attribute" data-type="EventHandler " href="#dom-serviceworkerglobalscope-ongeofenceerror">ongeofenceerror</a>;
};

[Exposed=ServiceWorker]
interface <a href="#geofenceevent">GeofenceEvent</a> : <a data-link-type="idl-name" href="https://slightlyoff.github.io/ServiceWorker/spec/service_worker/index.html#extendable-event-interface">ExtendableEvent</a> {
  readonly attribute <a data-link-type="idl-name" href="#geofence">Geofence</a> <a data-readonly="" data-type="Geofence " href="#dom-geofenceevent-geofence">geofence</a>;
  readonly attribute <a data-link-type="idl-name" href="http://www.w3.org/TR/geolocation-API/#position_interface">Position</a>? <a data-readonly="" data-type="Position? " href="#dom-geofenceevent-position">position</a>;
};

[Exposed=ServiceWorker]
interface <a href="#geofenceerrorevent">GeofenceErrorEvent</a> : <a data-link-type="idl-name" href="https://slightlyoff.github.io/ServiceWorker/spec/service_worker/index.html#extendable-event-interface">ExtendableEvent</a> {
  readonly attribute <a data-link-type="idl-name" href="#geofence">Geofence</a> <a data-readonly="" data-type="Geofence " href="#dom-geofenceerrorevent-geofence">geofence</a>;
  readonly attribute DOMString <a data-readonly="" data-type="DOMString " href="#dom-geofenceerrorevent-error">error</a>;
  readonly attribute DOMString <a data-readonly="" data-type="DOMString " href="#dom-geofenceerrorevent-message">message</a>;
};

</pre>
  <h2 class="no-num heading settled" id="issues-index"><span class="content">Issues Index</span><a class="self-link" href="#issues-index"></a></h2>
  <div style="counter-reset:issue">
   <div class="issue"> This should somehow mention how the [permissions] API is related to this.<a href="#issue-4cdf3c60"> ↵ </a></div>
   <div class="issue"> Somehow mention that the region that is saved as part of the registration can be slightly
    different from the region passed to register. An implementation may adjust parameters to
    be in range of what is possible, or otherwise modify the region.<a href="#issue-8ae02316"> ↵ </a></div>
  </div>
 </body>
</html>